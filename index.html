<!DOCTYPE html>
<html>
<head>
<title>Online Multiplayer Games</title>
<meta charset="UTF-8">
<meta name="description" content="Free web online games">
<meta name="keywords" content="online, games, no-ads, free">
<meta name="author" content="Aboud">
<meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no">
<meta charset="utf-8"/>
<style type="text/css">
body{
	padding:0;
	margin:0;
	background-color: #000000;
	background-image: linear-gradient(315deg, #000000 0%, #414141 74%);	
}
#gameBox{
	overflow:hidden;
}
#lobby{
	position:absolute;
	top:0;
	left:0;
	display:flex;
	width:100%;
	height:calc(var(--vh, 1vh) * 100);
	align-items:center;
	justify-content:center;
	flex-direction:column;
	background-color: #485461;
	background-image: linear-gradient(315deg, #485461 0%, #28313b 74%);	
}
button:active{
	transform:scale(0.9);
	transition:transform 100ms linear;
}
#roomsList{
	display:flex;
	align-items:center;
	justify-content:space-around;
	flex-direction:column;
	width:85%;
	max-width:500px;
	border-radius:10px;
	padding: 20px 1%;
	background:#538adc;
	background:#ba1c0f;
	background:#222;
	box-shadow:0 0 10px #aaa;
}
#roomsBox{
	display:flex;
	align-items:center;
	justify-content:flex-start;
	flex-direction:column;
	width:92%;
	max-width:480px;
	height:30vh;
	min-height:100px;
	background:white;
	border-radius:8px;
	overflow-y:auto;
	border:2px solid rgba(0,0,0,0.8);
	box-shadow:inset 0 0 5px rgba(0,0,0,0.6);
}
.roomBox{
	display:flex;
	align-items:center;
	justify-content:space-between;
	flex-direction:row;
	border-bottom: 3px solid #222;
	width:100%;
	/*background:linear-gradient(70deg,red,orange);*/
	user-select:none;
}
.roomBox:nth-child(odd){
background:#eb760c;
}
.roomBox:nth-child(even){
background:#faa814;
}
.roomBox:active,.roomBox.selected{
	background:linear-gradient(190deg,red,orange);
}
.roomBox .number,.roomBox .pCount{
	display:flex;
	align-items:center;
	justify-content:center;
	font-size:1.3em;
	padding:0.5em;
	font-weight:900;
	border-right:2px solid #222;
	color:#222;
}
.roomBox .info{
	display:flex;
	justify-content:space-around;
	flex-direction:column;
	width:100%;
	height:100%;
	padding: 0 0.5em;
	color:#222;
}
.roomBox .pCount{
border:none;
border-left:2px solid #222;
}
#roomBtn{
	display:flex;
	align-items:center;
	justify-content:space-around;
	width:92%;
	padding:10px;
}
#roomBtn button,#alert1 button{
	font-size:1em;
	font-weight:900;
	padding:6px;
	border-radius:5px;
	border:none;
	user-select:none;
	background: linear-gradient(145deg, #ffbd00, #df9f00);
	box-shadow:	0 0 5px #e2a100,
				0 0 5px #ffc100;
}
#roomBtn button:active, #alert1 button:active{
	transform:scale(0.9);
	transition:transform 100ms linear;
	background: linear-gradient(145deg, #e69e00, #ffbb00);
	box-shadow:	0  0 5px #e89f00,
				0 0 5px #ffbf00;
}
#alert1{
	position:absolute;
	top:50%;
	left:50%;
	transform:translate(-50%,-50%);
	width:70vw;
	min-width:200px;
	max-width:400px;
	min-height:120px;
	display:flex;
	align-items:space-around;
	justify-content:space-around;
	flex-direction:column;
	padding:1em;
	background:linear-gradient(190deg,#555,#333);
	border-radius:20px;
	z-index:999;
	box-shadow:	inset 0 0 8px #000;
	border:1px solid rgba(255,255,255,0.5);
}
#userRoomName{
	font-size:1.2em;
	padding:4px;
	border-color:#000;
	border-style:solid;
}
#userRoomName.red{
	border-color:#f00;
}
#userRoomName.red::placeholder{
	color:#f00;
}
#blackLayer{
position:fixed;
top:0;
left:0;
width:100%;
height:150%;
background:rgba(0,0,0,0.8);
z-index:99;
}
#chatSystem{
	position:fixed;
	top:0;
	right:0;
	background:#444;
	display:flex;
	flex-direction:column;
	width:300px;
	height:100%;
	transition:right 200ms ease-in-out;
	box-shadow:inset 0 0 8px #fff;
}
#chatSystem.closed{
	right:-300px;
}
#chatSystem #toggle svg path{
	d:path('M50,25 L75,50 L50,75');
}
#chatSystem.closed #toggle svg path{
	d:path('M50,25 L25,50 L50,75');
}
#toggle{
	position:absolute;
	top:50%;
	left:-30px;
	transform:translateY(-50%);
	display:flex;
	align-items:center;
	justify-content:center;
	width:30px;
	height:80px;
	background:orange;
	color:#fff;
	transform-origin:100% 50%;
	user-select:none;
	border-radius:50%;
	border-radius: 500px 0px 0px 500px;

}
#toggle:active{
	transition:transform 100ms linear;
	transform:translateY(-50%) scale(0.9);
}
#toggle svg{
	width:100%;
	height:100%;
}
#modeBox{
	display:flex;
	flex-direction:row;
	width:100%;
}
#modeBox button{
	width:50%;
	font-size:1.2em;
	font-weight:900;
	user-select:none;
	background:rgba(0,0,0,0.3);
	color:#fff;
	border:none;
}
#modeBox button.active{
	background:orange;
	color:#000;
}
#globalBox,#privateBox{
	display:flex;
	flex-direction:column;
	justify-content:flex-start;
	height:100%;
	width:100%;
	overflow:auto;
	box-sizing:border-box;
	padding:10px;
}
#privateBox{
	display:none;
}
#userInputBox{
	display:flex;
	width:100%;
}
#userInputBox input{
	width:100%;
	font-size:1.2em;
}
#userInputBox button{
	font-size:1.2em;
}
#chatSystem .msgBox{
	display:flex;
	width:100%;
	margin:4px 0;
}
#chatSystem .msgBox.me{
	justify-content:flex-end;
}
#chatSystem .msgBox.other{
	justify-content:flex-start;
}
#chatSystem .msgBox .msg{
	display:flex;
	align-items:space-around;
	justify-content:space-around;
	flex-direction:column;
	background:skyblue;
	border-radius:6px;
	min-width:20%;
	max-width:80%;
	padding:5px;
}
#chatSystem .msgBox.me .msg{
	background:#ff8;	
}
#chatSystem .msgBox h3{
	margin:0;
	padding:0;
}
#chatSystem .msgBox.me h3{
display:none;
}
#chatSystem .msgContent{
	overflow-y:auto;
	max-height:300vh;
	overflow-wrap: break-word;
	word-wrap: break-word;
	-ms-word-break: break-all;
	word-break: break-all;
	word-break: break-word;
	-ms-hyphens: auto;
	-moz-hyphens: auto;
	-webkit-hyphens: auto;
	hyphens: auto;
}
#myRoomBox{
	position:absolute;
	top:0;
	left:0;
	width:100%;
	height:100%;
}
#membersBox{
	position:absolute;
	top:50%;
	left:50%;
	transform:translate(-50%,-50%);
	display:flex;
	align-items:space-around;
	justify-content:space-around;
	flex-direction:row;
	flex-wrap:wrap;
	width:500px;
	max-width:80%;
}
#membersBox .member{
	position:relative;
	background:#777;
	box-shadow:inset 0 0 0.6em #000;
	width:20%;
	height:auto;
	margin:2.5%;
	color:#ddd;
	padding:0;
}
#membersBox .member img{
	width:100%;
	height:auto;
}
#membersBox .member .content{
	position:absolute;
	top:0;
	left:0;
	width:100%;
	height:100%;
	display:flex;
	align-items:center;
	justify-content:center;
	overflow:hidden;
}
#membersBox .member.ready{
	background:radial-gradient(circle,green,darkgreen);
}
#membersBox .member.unready{
	background:radial-gradient(circle,red,darkred);
}
#membersBox .member.battling{
	background:radial-gradient(circle,orange,gold);
}
#membersBox .member .teamColor{
	position:absolute;
	top:0;
	left:0;
	width:100%;
	height:5px;
	background:transparent;
}
#membersBox .member .teamColor.team0{background:rgba(0,0,0,0.2);}
#membersBox .member .teamColor.team1{background:red;}
#membersBox .member .teamColor.team2{background:yellow;}
#membersBox .member .teamColor.team3{background:#05a;}
#membersBox .member .teamColor.team4{background:#fff;}
#membersBox .member .teamColor.team5{background:lime;}
#membersBox .member .teamColor.team6{background:cyan;}
#membersBox .member .teamColor.team7{background:pink;}
#membersBox .member .teamColor.team8{background:orange;}

#bottomSection{
	position:absolute;
	bottom:0;
	left:0;
	width:100%;
	display:flex;
	align-items:center;
	justify-content:center;
}
#bottomSection button{
	width:50%;
	font-size:1.2em;
}
#fullScreenBtn{
	position:absolute;
	top:5px;
	right:5px;
	width:40px;
	height:40px;
	background:rgba(0,0,0,0.5);
	border-radius:5px;
}
#fullScreenBtn svg{
	width:100%;
	height:100%;
}
#fullScreenBtn:active,
#fullScreenBtn:hover{
	background:rgba(0,0,0,0.8);
}
#alert2,#prompt{
	position:absolute;
	top:50%;
	left:50%;
	transform:translate(-50%,-50%);
	display:flex;
	flex-direction:column;
	width:300px;
	font-size:1.1em;
	background:#eee;
	max-height:80%;
	overflow:hidden;
	border-radius:10px;
	z-index:999;
}
#alert2 .heading{
	width:100%;
	background:#aaa;
	text-align:center;
	text-align-last:center;
}
#alert2 .content{
	box-sizing:border-box;
	padding:15px;
	font-size:0.8em;
	margin:10px;
	text-align:center;
	text-align-last:center;
}
#alert2 button,#prompt button{
	font-size:1.6em:
	padding:6px;
}
.chessPiece{
	font-size:2em;
	padding:0.2em;
	border:0.1em solid #000;
	margin:0.25em;
}
.chessPiece:hover{
	background:rgba(10,255,40,0.8);
}
@keyframes chatPath{
	0%{
		d:path('M50,25 L25,50 L50,75');
	}
	100%{
		d:path('M50,25 L75,50 L50,75');
	}
}
@media (min-width:700px){
	body{
		font-size:30px;
	}
	#chatSystem{
		width:500px;
	}
	#chatSystem.closed{
		right:-500px;
	}
	#alert1 input,#alert1 button{
		font-size:16px;
	}
}
</style>
</head>
<body>
<div id="lobby">
	<section id="roomsList">
		<div id="roomsBox">
			<!--div class="roomBox">
				<span class="number">1</span>
				<div class="info">
					<span>Name: joinPlz</span>
					<span>Mode: duo</span>
				</div>
				<span class="pCount">4/6</span>
			</div-->
		</div>
		<div id="roomBtn">
			<button onclick="els.alert1.style.display = 'flex';blackLayer.style.display='block';userRoomName.focus();">Create Room</button>
			<button onclick="joinRoom(selectedRm);">Join Room</button>
		</div>	
	</section>
	<section id="myRoomBox" style="display:none;">
		<div class="topSection">
			<select id="userTeam">
				<option value="-1">none (solo)</option>
				<option value="0">team 1 (red)</option>
				<option value="1">team 2 (yellow)</option>
				<option value="2">team 3 (dark blue)</option>
				<option value="3">team 4 (white)</option>
				<option value="4">team 5 (green)</option>
				<option value="5">team 6 (blue)</option>
				<option value="6">team 7 (pink)</option>
				<option value="7">team 8 (orange)</option>
			</select>
		</div>
		<div id="membersBox">
			<!--div class="member ready">
				<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="/>
				<div class="content">user1</div>
			</div-->
		</div>
		<div id="bottomSection">
			<button onclick="leaveRoom();">leave</buttton>
			<button onclick="changeReady();">Ready</button>
		</div>
	</section>
	<section id="chatSystem" class="closed">
		<div id="toggle" onclick="els.chatSystem.classList.toggle('closed');if(els.chatSystem.className!='closed'){els.chatPath.style.animation = 'chatPath 200ms linear forwards';els.userInput.focus();}else{els.chatPath.style.animation = 'chatPath 200ms linear reverse';els.userInput.blur();}">
			<svg viewBox="0 0 100 100">
				<path id="chatPath" d="M50,25 L25,50 L50,75" stroke="#fff" fill="transparent" stroke-width="8"/>
			</svg>
		</div>
		<div id="modeBox">
			<button id="globalBtn" onclick="openBox(this,'global')" class="active">Global</button>
			<button id="privateBtn" onclick="openBox(this,'room')">Room</button>
		</div>
		<div id="globalBox"></div>
		<div id="privateBox"></div>
		<div id="userInputBox">
			<input id="userInput" type="text" placeholder="Type a message"/>
			<button id="sendBtn">send</button>
		</div>
	</section>
	<div id="alert1" style="display:none;">
		<input id="userRoomName" type="text" placeholder="Room Name (1-15 chars)"/>
		<select id="modesSelect"></select>
		<button onclick="createRoom();">create</buttom>
	</div>
</div>

<div id="gameBox" style="display:none">
	<canvas id="canvas"></canvas>
	<div id="fullScreenBtn">
		<svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M6 4h2v1H6a2 2 0 0 0-2 2v2H3V7a3 3 0 0 1 3-3zM4 18a2 2 0 0 0 2 2h2v1H6a3 3 0 0 1-3-3v-2h1v2zM17 4a3 3 0 0 1 3 3v2h-1V7a2 2 0 0 0-2-2h-2V4h2zm3 14a3 3 0 0 1-3 3h-2v-1h2a2 2 0 0 0 2-2v-2h1v2z" fill="#fff"/></svg>
	</div>
</div>
<div id="alert2" style="display:none;">
	<div class="heading">heading</div>
	<div class="content">content</div>
	<button onclick="this.parentNode.style.display = 'none';blackLayer.style.display = 'none';">ok</button>
</div>
<div id="prompt" style="display:none;">
	<p class="question">question</p>
	<input type="text" class="input">
	<button onclick="blackLayer.style.display='none';this.parentNode.style.display='none';this.myPromptCallBack(this.parentNode.children[1].value)">ok</button>
</div>
<div id="blackLayer" style="display:none;"></div>
<script>function addScr(n,d){var e=document.createElement("script");e.src=n,document.body.appendChild(e),e.onload=function(){d()}}addScr("https://cdn.jsdelivr.net/npm/eruda@2.4.1/eruda.min.js",function(){eruda.init()});</script>
<script type="text/javascript">
var url = "wss://lid-multigame.glitch.me/";
var ws = new WebSocket(url);
var myId = "me";
var selectedRm = -1;

var c = document.getElementById("canvas");
var ctx = c.getContext("2d");
var lastGame = "";
var serverGames = [];
var els = {};
getElements(els);
function getElements(obj){
	var all = document.getElementsByTagName("*");
	for(var i=0;i<all.length;i++){
		if(all[i].id){
			obj[all[i].id] = all[i]
		}
		if(all[i].classList[0]){
			for(var j=0;j<all[i].classList.length;j++){
				if(!obj[all[i].classList[j]]){obj[all[i].classList[j]] = new Array();}
				obj[all[i].classList[j]].push(all[i]);
			}
		}
	}
}
els.userTeam.onchange = function(){
	sendMsg("changeTeam",this.value);
}
els.alert2.hide = function(){
	this.style.display="none";
	blackLayer.style.display="none";
}
els.fullScreenBtn.addEventListener("click",toggleFullScreen);

var xoInfo = {
	box:{x:0,y:0,size:0},
	gameData:[-1,-1,-1,-1,-1,-1,-1,-1,-1],
	lineWidth:0,
	isClientTurn:false,
	turn:"",
};

var castlesInfo = {
	box:{x:0,y:0,width:0,height:0},
	castles:[],
	armies:[],
	castlesColor:["red","yellow","#05a","white","lime","cyan","pink","orange"]
};
var chessInfo = {
	box:{x:0,y:0,width:0,height:0},
	board:{
		cells:new Array(64),
		turn:0,
		time:0,
		yourTurn:0,
		width:8,
		height:8
	},
	shadowsPos:[],
	selectedPiece:undefined,
	boardInstance: undefined,
	textPieces:[
		"♔",
		"♚",
		"♕",
		"♛",
		"♖",
		"♜",
		"♗",
		"♝",
		"♘",
		"♞",
		"♙",
		"♟"
	],
	chessSvgPieces:['<svg xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 504 504" width="200" height="200"><g transform="translate(-213.41 -9.6261)"> <path fill="#000000" d="m203.31 470.98c-37.82-2.38-72.44-10.98-98.55-24.5-7.313-3.78-9.668-5.52-10.403-7.66-0.67-1.95-0.227-8.73 1.504-23l2.454-20.23-2.372-26.5-2.372-26.5-6.02-10.5c-8.287-14.46-18.199-29.13-30.075-44.5-16.93-21.92-22.602-31.4-27.228-45.5-2.394-7.3-2.799-10.2-2.865-20.5-0.064-9.93 0.327-13.29 2.266-19.5 7.194-23.03 22.734-40.01 43.512-47.56 19.539-7.09 37.909-7.04 60.819 0.16 22.26 7 50.12 23.89 70.47 42.73l5.92 5.48-2.21-8.76c-4.57-18.12-5.42-31.98-2.76-44.84 2.95-14.28 9.79-27.05 18.62-34.72 4.17-3.62 16.94-10.49 19.51-10.49 0.99 0 1.28-3.96 1.28-17.502v-17.5h-16.5-16.5v-7.5-7.5h16.5 16.5v-11-11h7.5 7.5v11 11h16 16v7.5 7.5h-16-16v17.25 17.252l7.25 3.26c16.31 7.34 26.88 21.75 31.16 42.45 2.65 12.86 1.8 26.72-2.77 44.84l-2.21 8.76 5.92-5.48c14.77-13.67 34.55-27.1 52.15-35.4 23.93-11.28 46.51-15.22 65.19-11.36 17.16 3.55 27.95 9.15 39.31 20.43 16.38 16.26 24.03 40.91 19.55 63.03-3.29 16.28-10.04 28.64-29.2 53.47-11.89 15.41-21.82 30.09-30.09 44.5l-6.03 10.5-2.37 26.5-2.37 26.5 2.45 20.23c1.73 14.27 2.17 21.05 1.5 23-0.73 2.14-3.09 3.88-10.4 7.66-26.95 13.95-60.12 22.02-101.04 24.57-18.94 1.18-75.28 1.14-94.5-0.07z" transform="translate(213.41 9.6261)"/> <path fill="#ffffff" d="m253.09 266.34c0.29-0.96 4.2-12.33 8.7-25.25 16.95-48.77 18.55-54.61 19.65-71.54 1.11-17.25-2.2-29.15-10.86-38.98-5.02-5.71-12.47-9.46-18.77-9.46-6.31 0-13.75 3.75-18.78 9.46-8.65 9.83-11.97 21.73-10.85 38.98 1.09 16.93 2.69 22.77 19.65 71.54 4.49 12.92 8.4 24.29 8.69 25.25 0.28 0.96 0.86 1.75 1.29 1.75 0.42 0 1-0.79 1.28-1.75z" transform="translate(213.41 9.6261)"/> <path fill="#ffffff" d="m401.73 322.02c6.47-11.73 19.86-31.47 32.17-47.43 18.7-24.25 23.64-34.18 24.6-49.45 1.06-16.9-3.96-30.54-15.44-41.98-11.95-11.9-25.86-16.74-45.25-15.73-18.12 0.95-34.24 6.5-54.87 18.92-33.44 20.13-63.63 55.07-71.81 83.13-1.98 6.77-6.4 26.83-8.66 39.23l-0.56 3.13 13.2 0.66c38.4 1.93 87.7 8.91 113.2 16.02 8.47 2.36 8.55 2.32 13.42-6.5z" transform="translate(213.41 9.6261)"/> <path fill="#ffffff" d="m125.31 326.22c29.26-6.69 63.08-11.37 95.5-13.22 11.27-0.64 20.6-1.24 20.72-1.34 0.51-0.42-6.83-34.68-9.03-42.18-8.25-28.13-38.4-63.01-71.83-83.13-20.63-12.42-36.74-17.97-54.86-18.92-19.395-1.01-33.312 3.83-45.254 15.73-11.495 11.45-16.528 25.14-15.416 41.93 1.028 15.52 6.186 25.8 25.344 50.51 11.684 15.07 24.983 34.76 31.366 46.43 5.16 9.43 2.59 8.97 23.46 4.19z" transform="translate(213.41 9.6261)"/> <path fill="#ffffff" d="m156.67 372.63c71.89-15.99 147.95-13.46 218.86 7.27l12.95 3.78 1.22-15.04c0.66-8.28 1.45-16.44 1.74-18.13l0.52-3.07-14.33-3.25c-82.01-18.61-169.64-18.61-251.65 0l-14.33 3.25 0.53 3.07c0.28 1.69 1.07 9.85 1.74 18.13l1.21 15.04 12.95-3.78c7.13-2.09 19.99-5.36 28.59-7.27z" transform="translate(213.41 9.6261)"/> <path fill="#ffffff" d="m153.31 409.08c36.73-9.52 59.76-12.43 98.5-12.43 21.19 0 32.21 0.46 43 1.78 27.63 3.38 58.41 10.38 83.26 18.92 9.91 3.41 12.66 4.04 12.3 2.82-0.26-0.87-0.77-4.84-1.14-8.82-0.37-3.97-1.18-7.89-1.8-8.7-1.38-1.82-23.66-8.38-42.29-12.45-70.2-15.35-145.79-12.88-214.17 7-7.52 2.18-14.17 4.64-14.79 5.45-0.61 0.81-1.42 4.73-1.8 8.7-0.37 3.98-0.88 7.95-1.14 8.82-0.36 1.22 2.39 0.59 12.3-2.82 7.02-2.41 19.52-6.13 27.77-8.27z" transform="translate(213.41 9.6261)"/> <path fill="#ffffff" d="m297.81 453.05c19.4-1.21 39.53-3.99 53.5-7.38 12.46-3.03 27.93-8.57 26.82-9.6-1.19-1.12-21.14-7.4-32.82-10.34-32.91-8.26-56.66-11.08-93.5-11.08-36.85 0-60.6 2.82-93.5 11.08-11.69 2.94-31.64 9.22-32.83 10.34-1.1 1.03 14.36 6.56 26.83 9.6 13.07 3.18 34.74 6.29 51 7.31 19.22 1.21 75.56 1.25 94.5 0.07z" transform="translate(213.41 9.6261)"/> </g> </svg>',
					'<svg xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 504 504" width="200" height="200"><g transform="translate(267.35 -46.409)"><g transform="translate(-.0000016318 560)"><path fill="#000000" d="m203.57-93.526c-35.66-2.272-64.83-9.044-89.82-20.854-12.59-5.95-11.64-2.8-8.44-28.03l2.23-17.5-2.31-25.5c-1.51-16.67-2.74-25.85-3.55-26.5-0.69-0.55-3.894-5.73-7.13-11.5-8.558-15.28-18.675-30.53-31.174-47-14.762-19.45-18.913-25.74-23.558-35.65-9.296-19.84-9.052-38.34 0.768-58.23 3.567-7.23 6.268-11.04 11.772-16.59 24.181-24.42 60.962-26.96 100.76-6.97 28.38 14.25 48.26 30.62 69.76 57.44 1.5 1.87 0.66-1.67-3.33-14-7.64-23.63-9-30.82-8.96-47.5 0.03-11.93 0.37-14.97 2.31-20.5 5.14-14.74 14.7-26.41 25.87-31.61l6.21-2.89 0.01-19.75 0.01-19.75h-16.5-16.5v-7.5-7.5h16.5 16.5v-11-11h7.5 7.5v11 11h16 16v7.5 7.5h-16-16v19.88 19.88l5.75 2.81c10.81 5.27 20.34 17.08 25.35 31.43 1.94 5.53 2.28 8.57 2.31 20.5 0.04 16.68-1.32 23.87-8.96 47.5-3.99 12.33-4.83 15.87-3.33 14 21.5-26.82 41.38-43.19 69.76-57.44 39.8-19.99 76.58-17.45 100.76 6.97 5.51 5.55 8.21 9.36 11.77 16.59 9.82 19.89 10.07 38.39 0.77 58.23-4.64 9.91-8.79 16.2-23.56 35.65-12.49 16.47-22.61 31.72-31.17 47-3.24 5.77-6.44 10.95-7.13 11.5-0.81 0.65-2.04 9.83-3.55 26.5l-2.31 25.5 2.23 17.5c3.19 25.17 4 22.19-7.44 27.57-14.05 6.6-21.08 9.14-35.89 12.96-16.36 4.221-35.92 7.095-57.36 8.431-18.98 1.183-75.38 1.137-94.43-0.077z" transform="translate(-267.35 46.409)"/><path fill="#ffffff" d="m253-270.11c0-0.93 6.53-21.12 14.51-44.85 15.73-46.78 18.14-55.73 19.11-70.95 1.23-19.39-3.43-34.47-13.84-44.82-7.33-7.3-11.54-9.15-20.78-9.15s-13.45 1.85-20.78 9.15c-10.41 10.35-15.07 25.43-13.84 44.82 0.97 15.22 3.38 24.17 19.11 70.95 7.98 23.73 14.51 43.92 14.51 44.85s0.45 1.7 1 1.7 1-0.77 1-1.7z" transform="translate(-267.35 46.409)"/><path fill="#ffffff" d="m130.18-210.93c21.66-6.17 47.89-11.14 74.82-14.16 21.68-2.43 72.32-2.43 94 0 26.93 3.02 53.16 7.99 74.82 14.16 6.77 1.94 13.15 3.52 14.17 3.52 3.56 0 7.96-5.18 15.14-17.8 10.21-17.96 19.79-32.46 32.49-49.2 14.36-18.92 18.97-25.81 22.58-33.79 15.23-33.58-0.67-71.56-34.7-82.93-7.16-2.39-9.46-2.67-22-2.65-11.86 0.01-15.46 0.41-23.57 2.59-26.07 7.01-51.67 22.59-74.4 45.29-13.23 13.2-22.79 25.93-30.44 40.52-5.52 10.53-10.12 26.64-14.27 49.92l-2.32 13.05h-4.5-4.5l-2.32-13.05c-4.15-23.28-8.75-39.39-14.27-49.92-7.65-14.59-17.21-27.32-30.44-40.52-22.73-22.7-48.33-38.28-74.4-45.29-8.11-2.18-11.71-2.58-23.57-2.59-12.536-0.02-14.836 0.26-22 2.65-34.035 11.37-49.929 49.35-34.702 82.93 3.615 7.98 8.222 14.87 22.578 33.79 12.707 16.74 22.28 31.24 32.494 49.2 7.18 12.62 11.58 17.8 15.14 17.8 1.02 0 7.4-1.58 14.17-3.52z" transform="translate(-267.35 46.409)"/><path fill="#ffffff" d="m132.92-156.34c23.28-8.57 50.55-15.15 77.58-18.73 9.7-1.29 20.23-1.72 41.5-1.72s31.8 0.43 41.5 1.72c27.17 3.6 54.29 10.16 77.91 18.85 12.11 4.46 14.83 4.42 17.46-0.27 1.98-3.53 0.76-7.57-2.97-9.84-4.62-2.8-32.41-11.78-48.3-15.59-31.52-7.57-52.14-9.97-85.6-9.97-39.7 0-71.45 4.73-107.78 16.05-24.88 7.75-30.22 10.62-30.22 16.2 0 2.69 4.13 7.23 6.58 7.23 0.92 0 6.47-1.77 12.34-3.93z" transform="translate(-267.35 46.409)"/><path fill="#ffffff" d="m126.11-116.3c27.66-12.52 66.42-22.2 100.19-25.04 50.24-4.21 103.7 4.48 150.14 24.43l8.4 3.61 5.08-2.57c11-5.57 4.73-10.8-26.42-22.05-33.5-12.09-75.76-19.47-111.5-19.47s-78 7.38-111.5 19.47c-30.88 11.15-37.33 16.44-26.75 21.94 2.61 1.36 5.03 2.5 5.36 2.52 0.34 0.03 3.49-1.25 7-2.84z" transform="translate(-267.35 46.409)"/><path fill="#000000" d="m243.69-318.16c-8.74-25.99-12.98-42-15.31-57.75-3.47-23.49 1.21-41.57 12.74-49.2 3.57-2.36 5.28-2.8 10.88-2.8s7.31 0.44 10.88 2.8c15.03 9.94 17.72 33.94 8.1 72.2-3.34 13.28-17.94 57.5-18.98 57.5-0.36 0-4.1-10.24-8.31-22.75z" transform="translate(-267.35 46.409)"/><path fill="#000000" d="m385-226.54c-1.38-0.56-9.25-2.76-17.5-4.91-28.7-7.45-56.79-11.58-86.03-12.64l-17.04-0.62 0.72-7.5c4.02-42.1 30.5-81.02 75.75-111.36 39.58-26.53 74.13-29.94 96.71-9.53 12.39 11.2 18 31.7 13.93 50.92-2.93 13.84-8.75 23.83-31.75 54.55-6.29 8.41-15.21 21.35-19.81 28.75-8.81 14.16-9.34 14.6-14.98 12.34z" transform="translate(-267.35 46.409)"/><path fill="#000000" d="m104.07-238.8c-4.633-7.45-13.572-20.42-19.865-28.83-17.811-23.79-21.958-29.98-26.288-39.22-9.082-19.38-9.166-37.78-0.252-54.74 7.941-15.12 25.3-24.82 44.385-24.82 22.75 0 52.32 13.81 81.03 37.83 33.26 27.84 52.38 60.92 55.78 96.52l0.73 7.65-10.04 0.01c-28.22 0.03-68.45 5.95-99.05 14.58-7.15 2.01-14.13 3.87-15.5 4.11-2.28 0.41-3.28-0.78-10.93-13.09z" transform="translate(-267.35 46.409)"/></g></g></svg>',
					'<svg xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 504 504" width="200" height="200"><g transform="translate(-319.92 -446.86)"> <path fill="#000000" d="m186 482.9c-29.18-1.53-57.03-8.5-78.35-19.6-10.411-5.43-13.65-8.39-13.65-12.48 0-1.39 4.271-12.32 9.49-24.31l9.49-21.79-8.92-20.48-8.923-20.49-18.239-22.33c-10.031-12.28-18.697-22.92-19.257-23.65s-5.775-39.35-11.588-85.81l-10.569-84.48-6.613-2.22c-8.08-2.72-13.149-6.46-17.016-12.54-6.8265-10.75-7.4802-22.35-1.8982-33.687 5.7162-11.611 16.183-17.819 30.043-17.819s24.327 6.208 30.043 17.819c6.625 13.457 4.668 25.647-6.433 40.077-0.577 0.75 9.249 21.99 27.992 60.52l28.878 59.37 4.2-72.95c2.3-40.12 4.22-74.41 4.25-76.18 0.06-2.75-0.49-3.52-3.68-5.17-6.73-3.47-12.03-8.905-15.46-15.875-8.4-17.07-1.02-36.417 17.21-45.097 11.28-5.371 25.13-2.933 35.71 6.286 2.49 2.172 5.55 6.39 7.5 10.353 2.84 5.77 3.29 7.721 3.29 14.229s-0.45 8.459-3.29 14.229c-1.94 3.93-4.96 8.112-7.33 10.143l-4.04 3.452 24.83 72.07c13.66 39.64 25.08 72.08 25.37 72.09 0.3 0.01 6.86-36.32 14.57-80.72l14.02-80.737-4.29-2.843c-9.57-6.336-14.82-16.151-14.83-27.705-0.02-13.445 7.41-24.618 20.49-30.847 7.79-3.707 18.21-3.707 26 0 8.15 3.881 13.45 9.005 17.21 16.639 2.84 5.772 3.29 7.717 3.28 14.208-0.01 11.554-5.26 21.369-14.83 27.705l-4.29 2.843 14.02 80.737c7.71 44.4 14.27 80.73 14.57 80.72 0.29-0.01 11.71-32.45 25.37-72.09l24.83-72.07-4.04-3.452c-2.37-2.031-5.39-6.213-7.33-10.143-8.4-17.07-1.02-36.417 17.21-45.097 7.79-3.707 18.21-3.707 26 0 8.15 3.881 13.45 9.005 17.21 16.639 2.84 5.77 3.29 7.721 3.29 14.229s-0.45 8.459-3.29 14.229c-3.43 6.97-8.73 12.405-15.46 15.875-3.19 1.65-3.74 2.42-3.68 5.17 0.03 1.77 1.95 36.06 4.25 76.18l4.2 72.95 28.88-59.37c18.74-38.53 28.57-59.77 27.99-60.52-11.1-14.43-13.06-26.62-6.43-40.077 5.71-11.611 16.18-17.819 30.04-17.819s24.33 6.208 30.04 17.819c5.59 11.337 4.93 22.937-1.89 33.687-3.87 6.08-8.94 9.82-17.02 12.54l-6.61 2.22-10.57 84.48c-5.82 46.46-11.03 85.08-11.59 85.81s-9.23 11.37-19.26 23.65l-18.24 22.33-8.92 20.49-8.92 20.48 9.49 21.79c5.22 11.99 9.49 22.92 9.49 24.31 0 4.09-3.24 7.05-13.65 12.48-16.52 8.6-36.61 14.69-59.29 17.97-8.52 1.23-23.61 1.57-78.06 1.72-37.12 0.11-69.97 0.07-73-0.09z" transform="translate(319.92 446.86)"/> <path fill="#ffffff" d="m260.08 68.322c5.18-3.492 7.92-8.238 7.92-13.726 0-12.206-14.27-20.339-24.08-13.726-5.18 3.493-7.92 8.239-7.92 13.726 0 12.207 14.27 20.339 24.08 13.726z" transform="translate(319.92 446.86)"/> <path fill="#ffffff" d="m372.08 88.322c5.18-3.492 7.92-8.238 7.92-13.726 0-5.487-2.74-10.233-7.92-13.726-9.81-6.613-24.08 1.52-24.08 13.726 0 12.207 14.27 20.339 24.08 13.726z" transform="translate(319.92 446.86)"/> <path fill="#ffffff" d="m148.08 88.322c10.64-7.17 10.64-20.282 0-27.452-9.81-6.613-24.08 1.52-24.08 13.726 0 12.207 14.27 20.339 24.08 13.726z" transform="translate(319.92 446.86)"/> <path fill="#ffffff" d="m471.98 127.84c5.18-2.6 8.02-7.47 8.02-13.74 0-9.23-6.47-15.501-16-15.501s-16 6.271-16 15.501c0 9.22 6.47 15.49 16 15.49 2.48 0 6.07-0.78 7.98-1.75z" transform="translate(319.92 446.86)"/> <path fill="#ffffff" d="m47.98 127.84c10.821-5.43 10.821-22.06 0-27.49-4.452-2.239-11.508-2.239-15.96 0-10.821 5.43-10.821 22.06 0 27.49 1.914 0.97 5.505 1.75 7.98 1.75s6.066-0.78 7.98-1.75z" transform="translate(319.92 446.86)"/> <path fill="#ffffff" d="m230.92 268.01c3.62-1.98 8.61-5.28 11.08-7.34 8.97-7.47 11.33-7.56 19.13-0.74 4.45 3.9 18.6 12.34 19.3 11.52 0.47-0.55-27.86-162.85-28.43-162.85-0.28 0-6.75 36.11-14.4 80.25-7.64 44.14-14.1 80.81-14.35 81.5-0.71 1.92 0.55 1.54 7.67-2.34z" transform="translate(319.92 446.86)"/> <path fill="#ffffff" d="m366.53 274.85c-0.33-3.72-2.38-38.93-4.56-78.25-2.18-39.33-4.08-72.69-4.22-74.15-0.14-1.53-11.34 29.55-26.65 74-14.52 42.16-26.64 77.28-26.92 78.06-0.86 2.34 12.98 0.49 22.79-3.05 12.51-4.51 14.34-4.63 18.78-1.22 3.72 2.84 19.01 11.27 20.56 11.33 0.45 0.01 0.54-3.01 0.22-6.72z" transform="translate(319.92 446.86)"/> <path fill="#ffffff" d="m145.27 277.98c3.98-2 9.38-5.19 12.01-7.11 5.61-4.09 6.87-4.05 19.75 0.59 9.81 3.54 23.65 5.39 22.79 3.05-0.28-0.78-12.4-35.9-26.92-78.06-15.31-44.45-26.51-75.53-26.65-74-0.14 1.46-2.04 34.82-4.22 74.15-2.18 39.32-4.23 74.53-4.56 78.25-0.32 3.71-0.33 6.75-0.01 6.75 0.33 0 3.84-1.63 7.81-3.62z" transform="translate(319.92 446.86)"/> <path fill="#ffffff" d="m439.94 232.1c4.4-35.15 7.87-64.03 7.71-64.19-0.26-0.25-55.92 113.73-57.44 117.6-0.46 1.19 1.08 1.28 9.87 0.59 17.73-1.38 16.73-1.57 24.47 4.71 3.82 3.1 7.04 5.53 7.16 5.41 0.13-0.13 3.83-28.98 8.23-64.12z" transform="translate(319.92 446.86)"/> <path fill="#ffffff" d="m86.55 285.77c1.986-1.04 3.986-1.09 9.427-0.25 9.703 1.51 18.373 1.42 17.743-0.17-1.48-3.8-57.121-117.69-57.365-117.44-0.161 0.16 3.287 28.84 7.664 63.74 4.376 34.89 7.962 63.81 7.969 64.26s2.719-1.35 6.027-4 7.149-5.41 8.535-6.14z" transform="translate(319.92 446.86)"/> <path fill="#ffffff" d="m113.07 346.04c90.16-31.01 187.7-31 277.87 0.01 4.1 1.41 7.77 2.22 8.16 1.8 2.43-2.57 26.85-32.85 26.83-33.25-0.02-0.28-3.23-3.01-7.14-6.08l-7.11-5.57-5.59 0.92c-17.34 2.85-42.85-2.75-61.38-13.48l-6.79-3.93-7.71 2.53c-25.17 8.26-50.44 4.76-72.96-10.12l-5.25-3.47-5.25 3.47c-12.75 8.42-27.44 13.43-42.3 14.41-10.35 0.68-19.36-0.58-30.66-4.29l-7.71-2.53-6.79 3.93c-18.53 10.73-44.04 16.33-61.381 13.48l-5.591-0.92-7.107 5.57c-3.908 3.07-7.018 5.89-6.909 6.28 0.171 0.61 26.908 33.8 27.228 33.8 0.07 0 3.46-1.15 7.54-2.56z" transform="translate(319.92 446.86)"/> <path fill="#ffffff" d="m151.2 384.76c66.18-21.42 135.42-21.42 201.6 0 8.42 2.72 17.27 5.79 19.67 6.82 3.17 1.36 4.51 1.55 4.87 0.7 0.27-0.65 3.18-7.31 6.45-14.81l5.95-13.62-3.62-1.16c-66.97-21.42-125.78-26.95-191.62-18.02-24.83 3.36-47.34 8.66-76.62 18.02l-3.62 1.16 5.95 13.62c3.27 7.5 6.18 14.16 6.45 14.81 0.36 0.85 1.7 0.66 4.87-0.7 2.4-1.03 11.25-4.1 19.67-6.82z" transform="translate(319.92 446.86)"/> <path fill="#ffffff" d="m151.5 426.08c19.55-4.83 40.86-8.57 60.5-10.64 16.29-1.71 63.71-1.71 80 0 27.32 2.87 65.82 10.76 85.75 17.56 3.99 1.36 7.25 2.3 7.25 2.07 0-0.22-2.19-5.48-4.87-11.69-5.79-13.43-4.87-12.78-30.35-21.23-17.35-5.76-37.27-10.24-58.78-13.23-17.53-2.43-60.47-2.43-78 0-21.51 2.99-41.43 7.47-58.78 13.23-25.48 8.45-24.56 7.8-30.35 21.23-2.68 6.21-4.87 11.47-4.87 11.69 0 0.23 3.26-0.71 7.25-2.07s15.35-4.47 25.25-6.92z" transform="translate(319.92 446.86)"/> <path fill="#ffffff" d="m337 463.28c13.86-2.01 22.5-4.02 33.87-7.9l9.36-3.19-6.86-2.33c-11.2-3.79-37.79-10.04-53.87-12.66-24.9-4.06-38.43-5.08-67.5-5.08s-42.6 1.02-67.5 5.08c-16.08 2.62-42.67 8.87-53.87 12.66l-6.86 2.33 9.36 3.21c15.15 5.19 33.46 8.48 52.87 9.5 3.02 0.16 35.88 0.2 73 0.09 54.33-0.15 69.55-0.49 78-1.71z" transform="translate(319.92 446.86)"/> </g> </svg>',
					'<svg xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 504 504" width="200" height="200"><g transform="translate(-520.31 -156.54)"> <path fill="#000000" d="m180.92 473.61c-20.71-1.46-39.95-5.48-55.39-11.58-9.34-3.69-21.01-9.7-22.02-11.34-0.32-0.52 3.71-10.81 8.95-22.88 5.25-12.06 9.54-22.45 9.54-23.09 0-1.26-15.85-37.93-18.99-43.93-1.04-1.99-9.971-13.46-19.852-25.49l-17.965-21.89-1.184-9.61c-0.652-5.3-5.545-44.5-10.874-87.12l-9.69-77.5-5.696-0.71c-16.446-2.06-26.268-16.68-21.282-31.69 2.119-6.38 5.358-10.329 11.388-13.874 3.944-2.318 5.777-2.73 12.145-2.73s8.201 0.412 12.145 2.73c6.03 3.545 9.269 7.494 11.388 13.874 3.618 10.89-1.093 23.07-11.086 28.67-1.156 0.64 6.241 16.63 36.683 79.27 20.97 43.15 38.19 78.54 38.27 78.64 0.2 0.28 10.7-187.8 10.65-190.82-0.04-2.25-0.67-2.783-4.35-3.71-5.97-1.503-12.05-6.19-15.38-11.862-2.42-4.117-2.82-5.861-2.82-12.371 0-6.687 0.36-8.157 3.03-12.5 10.05-16.328 32.89-16.328 42.94 0 2.68 4.354 3.03 5.804 3.03 12.579 0 6.764-0.35 8.23-3.02 12.578-1.8 2.937-5.05 6.263-8.06 8.249l-5.04 3.328 31.56 91.419c17.35 50.29 31.78 91.43 32.06 91.42 0.34 0 33.13-186.55 35.38-201.3 0.06-0.448-1.57-1.407-3.63-2.136-5.52-1.947-10.34-6.006-13.48-11.342-2.37-4.034-2.77-5.814-2.77-12.295 0-6.687 0.36-8.157 3.03-12.5 10.05-16.328 32.89-16.328 42.94 0 2.67 4.343 3.03 5.813 3.03 12.5 0 6.481-0.4 8.261-2.77 12.295-3.14 5.336-7.96 9.395-13.48 11.342-2.06 0.729-3.69 1.688-3.63 2.133 2.25 14.752 35.04 201.3 35.38 201.3 0.28 0.01 14.71-41.13 32.06-91.42l31.56-91.419-5.04-3.328c-3.01-1.986-6.26-5.312-8.06-8.249-2.67-4.348-3.02-5.814-3.02-12.578 0-6.775 0.35-8.225 3.03-12.579 10.05-16.328 32.89-16.328 42.94 0 2.67 4.343 3.03 5.813 3.03 12.5 0 6.51-0.4 8.254-2.82 12.371-3.33 5.672-9.41 10.359-15.38 11.862-3.68 0.927-4.31 1.46-4.35 3.71-0.05 3.02 10.45 191.1 10.65 190.82 0.08-0.1 17.3-35.49 38.27-78.64 30.44-62.64 37.84-78.63 36.68-79.27-9.99-5.6-14.7-17.78-11.08-28.67 2.12-6.38 5.35-10.329 11.39-13.874 3.94-2.318 5.77-2.73 12.14-2.73s8.2 0.412 12.14 2.73c6.03 3.545 9.27 7.494 11.39 13.874 4.99 15.01-4.83 29.63-21.28 31.69l-5.69 0.71-9.69 77.5c-5.33 42.62-10.23 81.82-10.88 87.12l-1.18 9.61-17.97 21.89c-9.88 12.03-18.81 23.5-19.85 25.49-3.14 6-18.99 42.67-18.99 43.93 0 0.64 4.29 11.03 9.54 23.09 5.24 12.07 9.27 22.36 8.95 22.88-2.29 3.71-26.34 13.78-41.79 17.51-22.4 5.39-26.88 5.66-99.7 5.91-37.12 0.13-72.26-0.1-78.08-0.5z" transform="translate(520.31 156.54)"/> <path fill="#ffffff" d="m130.5 361.67c17.3-6.48 34.44-11.38 52.5-15.01 26.37-5.31 37.84-6.37 69-6.37s42.63 1.06 69 6.37c18.15 3.65 35.22 8.54 52.8 15.13 14.96 5.6 17.33 5.69 20.14 0.69 2.31-4.12 0.55-7.81-5.05-10.59-8.28-4.12-32.46-12.06-49.1-16.14-32.98-8.09-53.46-10.55-87.79-10.55-15.57 0-30.83 0.53-37 1.29-34.44 4.24-64.52 11.5-92.74 22.38-10.48 4.04-13.26 6.26-13.26 10.57 0 2.67 4.12 7.24 6.53 7.24 0.9 0 7.63-2.26 14.97-5.01z" transform="translate(520.31 156.54)"/> <path fill="#ffffff" d="m154 404.88c19.95-8.59 40.61-14.45 63-17.88 16.03-2.46 53.87-2.47 70-0.02 23.34 3.54 45.84 10.18 68.41 20.18 10.27 4.55 12.34 5.15 14.79 4.3 5.51-1.92 6.5-8.18 1.91-12.04-6.92-5.82-40.52-18.32-62.11-23.1-22.62-5.01-32.89-6.09-58-6.09s-35.38 1.08-58 6.09c-21.59 4.78-55.19 17.28-62.11 23.1-4.52 3.8-3.78 9.56 1.5 11.78 2.55 1.07 3.62 1.07 6.1-0.03 1.66-0.74 8.19-3.57 14.51-6.29z" transform="translate(520.31 156.54)"/> <path fill="#ffffff" d="m121.8 456.29c5.19-2.68 34.81-12.38 47.2-15.46 14.12-3.51 30.3-6.41 46.5-8.33 14.35-1.69 58.65-1.69 73 0 31.86 3.77 61.03 10.95 88.71 21.83l8.71 3.43 4.09-2.09c4.57-2.33 5.5-3.85 4.58-7.49-0.81-3.25-6.18-5.92-24.59-12.27-78.2-26.95-157.8-26.95-236 0-18.41 6.35-23.78 9.02-24.59 12.27-0.9 3.59 0 5.14 4.29 7.4 4.61 2.43 4.72 2.44 8.1 0.71z" transform="translate(520.31 156.54)"/> </g> </svg>',
					'<svg xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 504 504" width="200" height="200"><g transform="translate(-554.82 -264.5)"> <path fill="#000000" d="m86.083 448.55c-4.536-2.48-5.032-5.43-4.697-27.94l0.309-20.74 2.805-2.42c2.537-2.18 3.711-2.41 12.25-2.41h9.44l0.01-17.75c0-15.83 0.21-18.07 1.93-20.75 1.07-1.65 10.5-12 20.96-23l19.04-20 0.02-71 0.03-71-23.54-17.9c-12.94-9.84-23.96-18.7-24.49-19.68-0.555-1.04-0.955-16.48-0.955-36.902 0-38.412 0.163-39.598 5.765-41.917 2.04-0.846 11.59-1.1 33.52-0.891 37.97 0.362 35.06-1.056 35.55 17.317l0.33 12.475h16.92 16.91v-10.532c0-12.228 1.34-16.534 5.68-18.331 2.14-0.889 12.74-1.133 40.09-0.922 45.53 0.35 41.57-1.279 42.07 17.31l0.33 12.475h16.92 16.91v-11.049c0-12.413 1.14-15.936 5.77-17.852 2.04-0.846 11.59-1.1 33.52-0.891 30.39 0.29 30.68 0.313 32.94 2.569 2.27 2.275 2.27 2.309 2.56 38.871 0.24 30.24 0.04 36.96-1.13 38.72-0.78 1.17-11.81 10.01-24.53 19.63l-23.11 17.5v71l-0.01 71 20.11 21.48c11.06 11.82 20.51 22.53 21 23.82 0.49 1.28 0.88 9.91 0.88 19.17v16.84l9.98 0.35c15.12 0.52 14.52-0.61 14.52 27.34 0 22.03-0.04 22.49-2.27 24.72l-2.28 2.28-164.72 0.22c-140.94 0.18-165.1 0.01-167.34-1.21h0.003z" transform="translate(554.82 264.5)"/> <path fill="#ffffff" d="m387.19 96.542v-24.5h-19.41-19.42l-0.33 12.475c-0.49 18.273 2.02 16.953-33.04 17.323-20.06 0.21-28.99-0.05-31.03-0.89-4.63-1.922-5.77-5.441-5.77-17.858v-11.05h-26-26v11.945c0 11.182-0.15 12.123-2.41 14.75l-2.41 2.803-28.27 0.3c-20.14 0.21-29.1-0.05-31.14-0.89-4.63-1.922-5.77-5.441-5.77-17.858v-11.05h-19.5-19.5v24.5 24.498h135 135v-24.498z" transform="translate(554.82 264.5)"/> <path fill="#ffffff" d="m357.47 148.79l12.14-9.25-58.71-0.26c-32.29-0.14-85.1-0.14-117.35 0l-58.64 0.26 11.89 9.2 11.89 9.2 93.32 0.05 93.32 0.05 12.14-9.25z" transform="translate(554.82 264.5)"/> <path fill="#ffffff" d="m338.19 242.04v-66h-86-86v66 66h86 86v-66z" transform="translate(554.82 264.5)"/> <path fill="#ffffff" d="m366.52 350.73c-1.01-1.27-6.55-7.35-12.33-13.5l-10.5-11.19h-91.57-91.58l-12.75 13.5-12.76 13.5h116.66 116.65l-1.82-2.31z" transform="translate(554.82 264.5)"/> <path fill="#ffffff" d="m380.19 383.04v-12h-128-128v12 12h128 128v-12z" transform="translate(554.82 264.5)"/> <path fill="#ffffff" d="m405.19 422.54v-9.5h-153-153l0.005 9.5v9.5h153 152.99v-9.5z" transform="translate(554.82 264.5)"/></g></svg>',
					'<svg xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 504 504" width="200" height="200"><g transform="translate(-523.71 -225.65)"> <path fill="#000000" d="m90 422.5v-18.5h12.5 12.5v-21.35-21.36l21-22.36 21-22.36v-74.56-74.56l-24.44-18.47-24.45-18.48-0.05-33.75-0.06-33.75h28.5 28.5v15 15h26 26v-15-15h35 35v15 15h26 26v-15-15h28.5 28.5l-0.05 33.75-0.05 33.75-24.45 18.5-24.45 18.5v74.7 74.69l20.97 22.31 20.97 22.3 0.03 21.25 0.03 21.25h12.5 12.5v18.5 18.5h-162-162v-18.5z" transform="translate(523.71 225.65)"/> <path fill="#ffffff" d="m387.55 134.55c1.35-1.35 2.45-3.62 2.45-5.05 0-1.42-1.1-3.7-2.45-5.05l-2.46-2.45h-133.09-133.09l-2.46 2.45c-1.35 1.35-2.45 3.63-2.45 5.05s1.1 3.7 2.45 5.05l2.46 2.45h133.09 133.09l2.46-2.45z" transform="translate(523.71 225.65)"/> <path fill="#ffffff" d="m337.55 172.55c1.35-1.35 2.45-3.62 2.45-5.05 0-1.42-1.1-3.7-2.45-5.05l-2.46-2.45h-83.09-83.09l-2.46 2.45c-1.35 1.35-2.45 3.63-2.45 5.05s1.1 3.7 2.45 5.05l2.46 2.45h83.09 83.09l2.46-2.45z" transform="translate(523.71 225.65)"/> <path fill="#ffffff" d="m337.55 321.55c1.35-1.35 2.45-3.62 2.45-5.05 0-1.42-1.1-3.7-2.45-5.05l-2.46-2.45h-83.09-83.09l-2.46 2.45c-1.35 1.35-2.45 3.63-2.45 5.05 0 1.43 1.1 3.7 2.45 5.05l2.46 2.45h83.09 83.09l2.46-2.45z" transform="translate(523.71 225.65)"/> <path fill="#ffffff" d="m379.09 367.72c4.34-3.34 4.6-8.07 0.64-11.75-2.07-1.94-4.21-1.97-127.73-1.97s-125.66 0.03-127.73 1.97c-3.96 3.68-3.7 8.41 0.64 11.75 2.31 1.77 251.87 1.77 254.18 0z" transform="translate(523.71 225.65)"/> <path fill="#ffffff" d="m379.09 409.72c4.34-3.34 4.6-8.07 0.64-11.75-2.07-1.94-4.21-1.97-127.73-1.97s-125.66 0.03-127.73 1.97c-3.96 3.68-3.7 8.41 0.64 11.75 2.31 1.77 251.87 1.77 254.18 0z" transform="translate(523.71 225.65)"/> </g> </svg> ',
					'<svg xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 504 504" width="200" height="200"><g transform="translate(-67.115 -584.71)"> <path fill="#000000" d="m57.352 455.07c-9.546-9.48-17.607-18.24-17.913-19.45-1.066-4.23 1.206-7.7 9.359-14.29 15.861-12.81 33.964-21.92 53.782-27.07 17.32-4.5 25.91-5.19 55-4.44 34.27 0.88 48.69-1.01 59.9-7.85l3.9-2.38-7.9-1.72c-13.39-2.91-31.4-9.35-44.44-15.89-17.98-9.01-17.35-6.19-8.87-39.92 3.77-14.98 6.86-27.69 6.86-28.24s-2.49-2.78-5.54-4.97c-14.79-10.59-26.22-27.83-31.62-47.69-1.83-6.71-2.25-10.77-2.19-20.84 0.1-14.98 2.21-23.91 8.9-37.66 10.54-21.67 24.7-35.68 64-63.36 13.42-9.45 24.47-17.58 32.25-23.694 1.34-1.054 0.86-1.861-3.55-6-7.29-6.848-10.69-14.573-10.69-24.303-0.02-13.445 7.41-24.618 20.49-30.847 7.78-3.707 18.21-3.707 26 0 8.15 3.881 13.45 9.005 17.21 16.639 6.53 13.272 3.68 28.088-7.42 38.511-4.4 4.139-4.88 4.946-3.54 6 7.77 6.114 18.83 14.244 32.25 23.694 39.3 27.68 53.46 41.69 64 63.36 6.68 13.75 8.79 22.68 8.89 37.66 0.07 10.07-0.36 14.13-2.18 20.84-5.4 19.86-16.84 37.1-31.63 47.69-3.04 2.19-5.54 4.42-5.53 4.97 0 0.55 3.09 13.26 6.85 28.24 8.49 33.73 9.12 30.91-8.86 39.92-13.04 6.54-31.05 12.98-44.44 15.89l-7.9 1.72 3.9 2.38c11.2 6.84 25.62 8.73 59.9 7.85 29.09-0.75 37.68-0.06 55 4.44 19.95 5.18 37.63 14.12 53.98 27.28 6.79 5.46 8.55 7.44 9.06 10.17 0.35 1.87 0.18 4.24-0.37 5.26-0.56 1.02-8.62 9.39-17.91 18.6-11.8 11.7-17.57 16.75-19.14 16.75-2.88 0-4.67-0.98-12.35-6.78-7.87-5.95-20.05-12.32-29.79-15.57-11.03-3.69-25.41-5.45-53.98-6.59-35.81-1.42-51.49-4.57-69.7-13.96l-9.3-4.79-9.3 4.79c-18.21 9.39-33.89 12.54-69.7 13.96-28.57 1.14-42.96 2.9-53.99 6.59-9.73 3.25-21.915 9.62-29.783 15.57-7.679 5.8-9.469 6.78-12.348 6.78-1.577 0-7.449-5.16-19.607-17.25z" transform="translate(67.115 584.71)"/> <path fill="#ffffff" d="m191.81 274.89c37.34-11.7 74.28-12.54 112.01-2.53 6.19 1.65 13.73 3.92 16.76 5.05l5.52 2.07 4.81-3.53c26.65-19.57 35.59-55.45 21.21-85.15-9.39-19.41-23.86-33.08-66.65-62.98-7.08-4.95-17.49-12.69-23.13-17.21l-10.26-8.21-10.26 8.21c-5.64 4.52-16.05 12.26-23.14 17.21-42.78 29.9-57.25 43.57-66.64 62.98-12.14 25.07-7.92 54.89 10.71 75.6 5.51 6.12 14.58 13.07 16.33 12.5 0.82-0.27 6.55-2.07 12.73-4.01z" transform="translate(67.115 584.71)"/> <path fill="#ffffff" d="m184.81 328.37c9.39-3.83 26.3-8.57 38.27-10.74 13.21-2.39 44.8-2.39 58 0 12.45 2.26 26.38 6.15 37.33 10.42 4.85 1.9 9.03 3.25 9.28 3 0.24-0.25-1.48-8.21-3.83-17.69-4.95-19.95-3.48-18.27-20.08-22.93-17.93-5.04-29.99-6.57-51.7-6.57s-33.77 1.53-51.7 6.57c-16.53 4.64-15.2 3.18-19.72 21.54-2.15 8.72-4.11 16.64-4.36 17.6-0.61 2.34 0.06 2.24 8.51-1.2z" transform="translate(67.115 584.71)"/> <path fill="#ffffff" d="m285.69 360.88c11.98-2.49 26.67-7.13 33.33-10.54l3.44-1.75-4.74-2.1c-8.42-3.72-25.87-8.93-36.14-10.77-13.97-2.52-45.04-2.52-59 0-10.27 1.84-27.73 7.05-36.14 10.77l-4.74 2.1 3.44 1.75c9.84 5.04 31.58 10.97 47.58 13 12.6 1.59 39.47 0.35 52.97-2.46z" transform="translate(67.115 584.71)"/> <path fill="#ffffff" d="m84.228 447.68c7.901-5.38 24.142-12.89 34.042-15.75 13.16-3.8 26.77-5.43 54.81-6.56 14.02-0.57 28.42-1.51 32-2.08 15.16-2.42 28.82-7.65 39.92-15.26 5.57-3.82 8.59-3.82 14.16 0 11.1 7.61 24.76 12.84 39.92 15.26 3.57 0.57 17.97 1.51 32 2.08 28.04 1.13 41.64 2.76 54.81 6.56 9.94 2.87 26.14 10.37 34.12 15.81l5.44 3.7 8.92-8.92 8.92-8.93-8.47-5.63c-13.42-8.93-26.8-14.58-43.24-18.26-6.85-1.53-13.39-1.8-45.5-1.89-37.26-0.11-37.56-0.13-47.33-2.76-5.4-1.46-12.32-3.79-15.38-5.19-6.41-2.94-16.48-9.95-20.73-14.43-2.78-2.95-3.33-3.11-10.56-3.11s-7.78 0.16-10.56 3.11c-4.25 4.48-14.32 11.49-20.74 14.43-3.05 1.4-9.97 3.73-15.37 5.19-9.77 2.63-10.07 2.65-47.33 2.76-32.11 0.09-38.65 0.36-45.5 1.89-16.305 3.65-29.302 9.11-43.143 18.13l-8.663 5.65 8.881 8.92c4.885 4.91 8.959 8.92 9.052 8.92 0.094 0 2.578-1.64 5.521-3.64z" transform="translate(67.115 584.71)"/> <path fill="#ffffff" d="m260.16 79.05c10.64-7.17 10.64-20.282 0-27.452-9.82-6.613-24.08 1.52-24.08 13.726 0 12.207 14.26 20.339 24.08 13.726z" transform="translate(67.115 584.71)"/> <path fill="#000000" d="m246.99 234.04c-3.24-2.49-3.91-5.57-3.91-18.07v-12.49l-13.59-0.33c-13.48-0.32-13.61-0.35-16-3.13-3.08-3.59-3.08-7.8 0-11.39 2.39-2.78 2.53-2.81 15.92-3.13l13.52-0.33 0.32-13.51c0.33-13.39 0.35-13.54 3.13-15.92 3.59-3.09 7.81-3.09 11.39 0 2.78 2.38 2.81 2.53 3.13 15.92l0.33 13.51 13.51 0.33c13.4 0.32 13.54 0.35 15.93 3.13 3.08 3.59 3.08 7.8 0 11.39-2.39 2.78-2.53 2.81-16 3.13l-13.59 0.33v12.49c0 12.5-0.67 15.58-3.91 18.07-2.05 1.57-8.13 1.57-10.18 0z" transform="translate(67.115 584.71)"/> </g> </svg>',
					'<svg xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 504 504" width="200" height="200"><g transform="translate(-644.53 -535.4)"> <path fill="#000000" d="m62.695 460.2l-14.737-14.77 3.271-3.09c9.747-9.22 28.802-20.06 44.382-25.24 18.679-6.21 21.399-6.5 62.389-6.62 35.2-0.11 37.99-0.25 45.5-2.29 11.23-3.05 21.43-8.48 29.01-15.42 7.7-7.06 8.17-8.77 2.37-8.77-5.98 0-27.91-4.62-38.38-8.08-12.14-4.02-33.5-14.51-33.5-16.46 0-0.83 3.15-14.09 7-29.46s6.99-28.3 6.97-28.72c-0.01-0.43-3.21-2.8-7.11-5.28-30.93-19.63-42.46-61.82-26.4-96.62 9.66-20.92 23.9-34.9 64.14-62.96 19.59-13.66 36.66-26.79 41.23-31.71l2.33-2.51-4.11-0.69c-5.8-0.98-12.96-6.154-16.52-11.932-2.68-4.354-3.03-5.804-3.03-12.578s0.35-8.224 3.03-12.578c10.05-16.328 32.89-16.328 42.94 0 2.68 4.354 3.03 5.804 3.03 12.578s-0.35 8.224-3.03 12.578c-3.56 5.778-10.72 10.952-16.52 11.932l-4.11 0.69 2.33 2.51c4.57 4.92 21.64 18.05 41.23 31.71 40.24 28.06 54.48 42.04 64.14 62.96 16.06 34.8 4.53 76.99-26.4 96.62-3.9 2.48-7.1 4.85-7.11 5.28-0.02 0.42 3.12 13.35 6.97 28.72s7 28.63 7 29.46c0 1.95-21.36 12.44-33.5 16.46-10.47 3.46-32.4 8.08-38.38 8.08-5.8 0-5.33 1.71 2.37 8.77 7.58 6.94 17.78 12.37 29.01 15.42 7.51 2.04 10.3 2.18 45.5 2.29 31.98 0.09 38.68 0.37 45.5 1.89 19.49 4.33 39.19 13.05 53.38 23.63 12.97 9.68 13.32 7.33-3.68 24.3l-14.73 14.71-5.94-4.44c-15.12-11.32-34.38-19.22-53.53-21.98-5.78-0.83-21.97-1.97-36-2.53-14.02-0.56-29.52-1.72-34.43-2.58-12.87-2.24-26.59-7.08-35.84-12.64-4.43-2.66-8.36-4.84-8.73-4.84s-4.3 2.18-8.73 4.84c-9.25 5.56-22.97 10.4-35.84 12.64-4.91 0.86-20.4 2.02-34.43 2.58-36.43 1.45-51.08 4.01-68.75 11.99-5.298 2.39-17.312 9.86-24.784 15.4-1.933 1.43-2.767 0.77-16.771-13.25z" transform="translate(644.53 535.4)"/> <path fill="#ffffff" d="m260 226.5v-12.5h12 12v-7.5-7.5h-12-12v-12.5-12.5h-7.5-7.5v12.5 12.5h-12.5-12.5v7.5 7.5h12.5 12.5v12.5 12.5h7.5 7.5v-12.5z" transform="translate(644.53 535.4)"/> <path fill="#ffffff" d="m205.27 302.48c4.82-1.98 13.15-4.77 18.5-6.2 8.81-2.35 11.48-2.6 28.23-2.6s19.42 0.25 28.23 2.6c7.76 2.07 21.01 6.89 28.28 10.28 0.86 0.4 7.49-10.15 7.49-11.92 0-1.03-9.08-5.26-18.12-8.45-16.43-5.8-27.56-7.65-45.88-7.65s-29.45 1.85-45.88 7.65c-9.04 3.19-18.12 7.42-18.12 8.45 0 1.77 6.63 12.32 7.49 11.92 0.56-0.26 4.96-2.1 9.78-4.08z" transform="translate(644.53 535.4)"/> <path fill="#ffffff" d="m185.32 363.13c17.65-12.11 44.18-20.12 66.68-20.12s49.03 8.01 66.68 20.12c2.3 1.58 4.38 2.87 4.63 2.87 0.51 0 8.69-10.68 8.69-11.34 0-1.08-13.52-9.04-23-13.55-23.92-11.38-50.02-15.37-75.68-11.56-14.21 2.11-25.83 5.61-38.32 11.56-9.48 4.51-23 12.47-23 13.55 0 0.66 8.18 11.34 8.69 11.34 0.25 0 2.33-1.29 4.63-2.87z" transform="translate(644.53 535.4)"/> </g> </svg>',
					'<svg xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 504 504" width="200" height="200"><g transform="translate(267.69 -489.52)"><path fill="#000000" d="m155.21 472.75c-8.08-4.03-9.28-27.81-2.43-47.96 5.86-17.22 12.62-26.32 38.46-51.77 23.28-22.93 29.48-30.48 36.72-44.7 8.65-16.97 12.05-30.4 12.96-51.05 0.32-7.29 0.34-13.25 0.05-13.25s-5.2 2.85-10.9 6.34c-5.7 3.48-18.53 10.48-28.52 15.55-37.9 19.24-43.85 24.89-60.76 57.69-3.14 6.09-7.72 13.64-10.19 16.78-7.88 10.05-20.56 17.64-29.45 17.64-3.794 0-10.746-2.61-14.429-5.42-1.717-1.31-3.934-4.18-4.927-6.38-1.633-3.63-2.243-4.07-6.446-4.69-28.706-4.23-49.063-29.2-46.807-57.42 1.451-18.14 9.614-36.28 30.142-66.97 14.049-21 19.759-31.19 23.676-42.24 2.03-5.73 2.266-8.28 2.304-24.88l0.043-18.5 3.239-6.84c2.699-5.7 5.539-9.12 17.025-20.5 7.58-7.51 15.08-15.59 16.68-17.96l2.9-4.3-2.2-27.7c-3.02-38.182-3.03-38.083 3.18-40.693 4.23-1.778 4.02-1.877 35.99 17.358 14.75 8.874 27.16 16.135 27.58 16.135s8.32-8.09 17.56-17.978c13.92-14.899 17.39-18.09 20.26-18.628 6.11-1.146 7.55 0.899 19.98 28.219l11.4 25.044 6.2-0.909c8.91-1.305 30.6-0.154 41.86 2.22 20.46 4.311 40.77 13.106 57.21 24.772 10.98 7.79 28.66 25.67 36.84 37.26 17.69 25.05 30.51 53.08 42.26 92.42 20.17 67.54 32.6 146.52 32.93 209.29 0.1 19.77 0.06 20.27-2.17 22.5l-2.28 2.29-156.72 0.24c-123.65 0.19-157.25-0.02-159.22-1.01z" transform="translate(-267.69 489.52)"/><path fill="#ffffff" d="m155.79 67.859c-8.85-5.313-16.21-9.537-16.37-9.385-0.15 0.152 0.26 7.471 0.92 16.265l1.19 15.989 15.17-6.604 15.18-6.604-16.09-9.661z" transform="translate(-267.69 489.52)"/><path fill="#ffffff" d="m458.84 455.47c2.89-2.88 2.89-3.01-0.22-42.45-5.8-73.68-23.77-160.39-43.62-210.5-5.81-14.67-16.89-35.65-24.56-46.5-16.46-23.29-40.93-42.35-65.82-51.29-14.92-5.364-26.48-7.217-44.41-7.125-10.72 0.055-19.12 0.629-23.97 1.636-4.1 0.849-7.99 1.349-8.62 1.109-0.64-0.25-4.67-8.185-8.96-17.639-4.29-9.455-8.92-19.637-10.29-22.625l-2.48-5.435-15.59 16.102-15.59 16.101-27.17 11.691-27.16 11.695-6.55 8.77c-3.61 4.82-11.07 12.94-16.6 18.04-14.83 13.68-14.51 12.94-14.6 33.97-0.06 15.06-0.38 18.54-2.3 25-3.786 12.73-12.22 28.62-26.529 50-15.697 23.45-23.863 39.04-26.195 50.01-1.982 9.32-1.399 20.97 1.358 27.11 4.868 10.85 16.831 19.45 28.568 20.55l6.421 0.6 6.698-8.89c3.684-4.88 7.678-9.43 8.876-10.09 4.843-2.71 10.063-0.99 12.153 4 1.77 4.19 0.89 6.21-7.6 17.52-3.85 5.12-6.854 10.07-6.678 11 0.58 3.06 6.798 2.7 11.438-0.66 6.42-4.65 10.71-10.66 19.43-27.21 4.47-8.49 10.08-18.18 12.47-21.53 9.17-12.87 23.01-22.89 51.81-37.53 28.34-14.4 53.4-30.38 60.8-38.77 8.72-9.89 12.42-21.42 11.55-36.04-0.65-10.96 0.46-14.23 5.4-15.95 2.5-0.87 3.83-0.78 6.46 0.47 4.18 1.99 5.47 5.43 6.16 16.44 1.06 16.8-6.47 36.65-18.57 48.96l-6.64 6.76 0.8 6.37c1.2 9.5 0 31.09-2.3 41.38-4.54 20.28-13.07 39.59-24.24 54.84-3.31 4.53-15.67 17.74-27.74 29.66-21.53 21.27-27.76 28.8-32.65 39.5-3.12 6.8-5.33 17.26-5.36 25.25l-0.01 6.25h141.44c93.21 0 141.65 0.34 142.06 1 1.21 1.96 6.53 1.05 9.13-1.55z" transform="translate(-267.69 489.52)"/><path fill="#000000" d="m115.28 190.86c4.52-8.52 17.57-29.5 20.22-32.52 5.39-6.14 13.75-8.77 20.14-6.34 1.41 0.53 2.57 1.55 2.57 2.27 0 3.11-8.11 14.86-15.03 21.76-5.71 5.7-9.57 8.52-16 11.7-4.66 2.3-9.53 4.48-10.81 4.83-2.18 0.61-2.26 0.5-1.09-1.7z" transform="translate(-267.69 489.52)"/><path fill="#000000" d="m53.403 313.38c0.381-7.92 1.013-11.14 3.074-15.64 2.728-5.96 7.177-9.71 11.529-9.72 5.627-0.01 11.2 5.62 11.2 11.3 0 4.31-4.313 8.95-15.392 16.56l-10.892 7.48 0.481-9.98z" transform="translate(-267.69 489.52)"/></g></svg>',
					'<svg xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 504 504" width="200" height="200"><g transform="translate(-572.77 -269.79)"><path fill="#000000" d="m157.19 457.86c-1.46-13.67 1.35-29.06 7.56-41.36 5.12-10.15 12.11-18.38 33.98-40 12.97-12.83 23.85-24.53 26.97-29 10.14-14.55 17.9-32.54 21.66-50.23 1.93-9.07 2.52-33.8 1.06-44.05l-0.83-5.79-6.17 4.39c-11.51 8.18-23.12 15-43.83 25.77-39.56 20.57-46.31 26.67-61.27 55.34-8.36 16.02-13.15 23.14-19.08 28.37-4.77 4.2-11.75 7.2-16.72 7.2-6.569 0-12.765-6.19-12.773-12.75l-0.004-3.25h-5.45c-8.085 0-15.238-1.8-22.774-5.72-20.569-10.71-27.733-33.7-18.805-60.35 4.271-12.75 8.353-20.19 23.843-43.43 16.097-24.16 21.043-33.04 25.343-45.5 3.219-9.33 3.279-9.83 3.331-27.5 0.067-22.53-0.059-22.25 17.949-40 15.06-14.83 21.56-23.86 21.56-29.91 0-2.162-0.92-15.136-2.06-28.832-1.13-13.697-1.92-25.999-1.75-27.339 0.3-2.299 2.03-1.407 30.92 15.938l30.6 18.373 18.19-19.365c10.01-10.651 18.54-19.365 18.96-19.365s6.24 12.038 12.93 26.75c6.7 14.712 12.55 26.665 13.01 26.562 6.73-1.52 20.93-2.466 30.2-2.01 35.46 1.741 65.89 15.428 91.5 41.148 23.65 23.75 39.07 51.15 54.08 96.05 20.99 62.83 34.72 142.81 37.08 216.05l0.66 20.45h-154.58-154.58l-0.71-6.64z" transform="translate(572.77 269.79)"/><path fill="#ffffff" d="m126.72 187.21c6.43-3.18 10.29-6 16-11.7 6.91-6.9 15.02-18.65 15.02-21.76 0-3.35-9.35-4.18-15.51-1.39-5.49 2.5-9.07 6.88-18.28 22.37-11.24 18.91-10.86 18.09-8.04 17.31 1.28-0.35 6.15-2.53 10.81-4.83z" transform="translate(572.77 269.79)"/><path fill="#ffffff" d="m76.493 304.54c1.238-1.83 2.25-4.42 2.25-5.74 0-5.68-5.572-11.31-11.2-11.3-4.351 0.01-8.801 3.76-11.528 9.72-2.061 4.5-2.693 7.72-3.075 15.64l-0.48 9.98 10.891-7.48c5.991-4.11 11.905-8.98 13.142-10.82z" transform="translate(572.77 269.79)"/><path fill="#ffffff" d="m458.38 454.95c2.51-2.51 2.54-2.71 1.89-13.25-3.64-59.55-10-105.29-22.14-159.2-10.28-45.67-20.78-77.34-34.5-104-9.03-17.56-18.01-30.14-30.38-42.53-19.28-19.31-40.06-30.74-66.59-36.611-18.53-4.102-53.48-2.712-58.9 2.341-2.95 2.74-2.43 8.42 0.99 10.96 2.38 1.77 3 1.79 12.5 0.36 37.43-5.64 72.03 5.22 99.64 31.26 27.07 25.53 46.05 68.31 62.24 140.22 11.73 52.09 18.17 97.19 21.65 151.5 0.96 15.07 1.32 17.25 3.2 19.25 2.85 3.04 7.19 2.92 10.4-0.3z" transform="translate(572.77 269.79)"/></g></svg>',
					'<svg xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 504 504" width="200" height="200"><g transform="translate(-387.21 -272.99)"><path fill="#000000" d="m99.308 458.99c-6.102-2.46-8.646-14.33-8.673-40.49-0.022-21.65 1.499-31.06 8.339-51.61 12.976-38.99 41.396-72.77 76.586-91.04l10.06-5.22-5.06-4.12c-10.79-8.79-20.39-23.95-24.75-39.06-1.86-6.47-2.28-10.28-2.23-20.45 0.06-10.86 0.43-13.61 2.84-21 7.54-23.07 20.75-38.57 41.58-48.82l9.5-4.68-4.23-6.3c-8.46-12.63-11.1-27.796-7.28-41.935 4.24-15.733 12.73-26.072 27.3-33.251 18.81-9.274 38.61-9.274 57.42 0 14.57 7.179 23.06 17.518 27.3 33.251 3.82 14.139 1.18 29.305-7.28 41.935l-4.23 6.3 9.5 4.68c20.83 10.25 34.04 25.75 41.58 48.82 2.41 7.39 2.78 10.14 2.84 21 0.05 10.17-0.37 13.98-2.23 20.45-4.36 15.11-13.96 30.27-24.75 39.06l-5.06 4.12 10.06 5.22c35.19 18.27 63.61 52.05 76.59 91.04 6.84 20.55 8.36 29.96 8.33 51.61-0.02 26.65-2.56 38.11-8.98 40.55-3.23 1.22-302.02 1.17-305.07-0.06h-0.002z" transform="translate(387.21 272.99)"/><path fill="#ffffff" d="m394.73 439.25c0.42-1.51 0.74-11.07 0.7-21.25-0.07-20.62-1.75-31.25-7.55-47.69-14.2-40.25-47.26-73.64-86.88-87.76-9.96-3.54-11.78-4.85-12.57-9.05-0.97-5.21 1.26-7.7 11.27-12.52 31.24-15.08 42.62-53.88 24.81-84.6-4.83-8.33-16.11-18.59-25.64-23.31-7.96-3.94-12.1-5-25.97-6.61-5.14-0.6-8.53-3.15-9.54-7.17-1.05-4.17 1.51-7.45 8.6-11.03 8.05-4.05 13.36-9.18 16.84-16.26 2.36-4.8 2.7-6.7 2.7-14.998 0-8.364-0.33-10.177-2.78-15.161-3.45-7.02-8.99-12.123-17.6-16.201-6.32-2.997-7.18-3.138-19.12-3.138s-12.8 0.141-19.12 3.138c-8.61 4.078-14.15 9.181-17.6 16.201-2.45 4.984-2.78 6.797-2.78 15.161 0 8.298 0.34 10.198 2.7 14.998 3.48 7.08 8.79 12.21 16.84 16.26 7.09 3.58 9.65 6.86 8.6 11.03-1.01 4.02-4.4 6.57-9.54 7.17-13.87 1.61-18.01 2.67-25.97 6.61-9.53 4.72-20.81 14.98-25.64 23.31-7.28 12.55-9.98 27.84-7.52 42.47 2.95 17.47 15.72 34.12 32.33 42.13 10.01 4.82 12.24 7.31 11.27 12.52-0.79 4.2-2.61 5.51-12.57 9.05-39.62 14.12-72.68 47.51-86.88 87.76-5.8 16.44-7.48 27.07-7.55 47.69-0.04 10.18 0.28 19.74 0.7 21.25l0.77 2.75h141.96 141.96l0.77-2.75z" transform="translate(387.21 272.99)"/></g></svg>',
					'<svg xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 504 504" width="200" height="200"><g transform="translate(-458.89 -202.89)"> <path fill="#000000" d="m559.76 645.59c-2.22-13.35-1.75-39.94 0.95-53.48 8.23-41.36 32.37-77.37 66.68-99.5 10.97-7.08 21.38-12.03 36.5-17.38 0.93-0.33-1.53-2.1-6.5-4.68-11.96-6.21-22.72-17.3-28.86-29.73-6.01-12.17-8-21.41-7.32-33.98 0.97-18.05 7.66-32.94 20.68-46.02 11.64-11.7 30.03-19.98 44.36-19.98h5.03l-5.44-2.7c-7.1-3.51-15.86-12.34-19.34-19.46-7.98-16.38-4.91-35.67 7.68-48.26 19.31-19.31 54.11-19.31 73.42 0 12.59 12.59 15.66 31.88 7.68 48.26-3.47 7.12-12.24 15.95-19.33 19.46l-5.45 2.7h5.04c14.33 0 32.71 8.28 44.35 19.98 13.02 13.08 19.71 27.97 20.69 46.02 0.68 12.57-1.31 21.81-7.32 33.98-6.14 12.43-16.91 23.52-28.87 29.73-4.97 2.58-7.43 4.35-6.5 4.68 15.13 5.35 25.53 10.3 36.5 17.38 34.32 22.13 58.45 58.14 66.68 99.5 2.7 13.54 3.17 40.13 0.95 53.48l-1.37 8.25h-149.76-149.75l-1.38-8.25z"/> </g> </svg>'
	],
	imgPieces:[],
	img:false,
	kingChecked:false,
	chessColors:["rgb(227,193,111)","rgb(184,139,74)"],
	chessClasses:["ChessKing","ChessQueen","ChessRook","ChessBishop","ChessKnight","ChessPawn"]

};

	function svgToImg(svg,callback,error){
		var svg64;
		try{svg64 = window.btoa(svg);}catch(e){error(e);}
		var newImg = new Image();
		newImg.onload = callback || function(){};
		newImg.onerror = error || function(){};
		newImg.src = "data:image/svg+xml;base64,"+svg64;
	}
	for(var i=0;i<chessInfo.chessSvgPieces.length;i++){
		loopCallbackSvg(i);
	}
	function loopCallbackSvg(i){
		svgToImg(chessInfo.chessSvgPieces[i],function(){
			chessInfo.imgPieces[i] = this;
			chessInfo.img = true;
		},null);
	}

els.alert1.getData = function(){
	var userRoomName = document.getElementById("userRoomName");
	var modesSelect = document.getElementById("modesSelect");
	return {
		roomName:userRoomName.value,
		modeName:modesSelect.value
	};
}
var blackLayer = document.getElementById("blackLayer");

var temp,tx=0;
var lastTouchstart=0;
els.toggle.addEventListener("touchstart",function(e){
	lastTouchstart = Date.now();
	temp = els.chatSystem.style.transition;
	els.chatSystem.style.transition = "all 5ms linear";
});
els.toggle.addEventListener("touchmove",function(e){
	tx = Math.min(e.touches[0].clientX*-1+window.innerWidth,els.chatSystem.clientWidth);
	els.chatSystem.style.right = (tx-els.chatSystem.clientWidth)+"px";
});
els.toggle.addEventListener("touchend",function(e){
	els.chatSystem.style.transition = temp;
	els.chatSystem.removeAttribute("style");
	var et = Date.now() - lastTouchstart;
	if(tx<els.chatSystem.clientWidth/2 && et>160){
		els.chatSystem.classList.add("closed");
		els.userInput.blur();
	}
	else if(et>160){
		els.chatSystem.classList.remove("closed");
		els.userInput.focus();
	}
});
els.toggle.addEventListener("touchcancel",function(e){
	els.chatSystem.style.transition = temp;
	els.chatSystem.removeAttribute("style");
	var et = Date.now() - lastTouchstart;
	if(tx<els.chatSystem.clientWidth/2 && et>160){
		els.chatSystem.classList.add("closed");
		els.userInput.blur();
	}
	else if(et>160){
		els.chatSystem.classList.remove("closed");
		els.userInput.focus();
	}
});
els.chatPath.addEventListener("animationend",function(){
	els.chatPath.style.animation = "";
});
document.body.addEventListener("keydown", function(event) {
  if (event.keyCode === 13 && !els.chatSystem.classList.contains("closed")) {
    if(oBox === "global"){
			sendMsg("globalMessage",els.userInput.value);
		}
		else if(oBox === "room"){
			sendMsg("roomMessage",els.userInput.value);
		}
		els.userInput.value = "";
	}else if(event.keyCode === 27){
		if(!els.chatSystem.classList.contains("closed")){
			els.chatSystem.classList.add("closed");
			els.userInput.blur();
		}
	}
});
var lastBlurTime;
els.userInput.addEventListener("blur",function(){
	if(oBox=="global"){els.globalBox.scrollTo(0,els.globalBox.scrollHeight);}
	if(oBox=="room"){els.privateBox.scrollTo(0,els.privateBox.scrollHeight);}
});
els.userInput.addEventListener("blur",function(){lastBlurTime=Date.now();});
els.sendBtn.addEventListener("click",function(){
	if(els.userInput.value.length > 0){
		if(oBox === "global"){
			sendMsg("globalMessage",els.userInput.value);
		}
		else if(oBox === "room"){
			sendMsg("roomMessage",els.userInput.value);
		}
		els.userInput.value = "";
	}
	if(Date.now()-lastBlurTime<100){
		els.userInput.focus();
	}
});

function toggleFullScreen(){
	if (!document.fullscreenElement && !document.mozFullScreenElement && !document.webkitFullscreenElement){
		document.documentElement.requestFullscreen = document.documentElement.requestFullscreen || document.documentElement.mozRequestFullscreen || document.documentElement.webkitRequestFullscreen;
		if(document.documentElement.requestFullscreen){
			document.documentElement.requestFullscreen();
		}
	}
	else{
		document.cancelFullScreen = document.cancelFullScreen || document.mozCancelFullScreen || document.webkitCancelFullScreen;
		if (document.cancelFullScreen) {
			document.cancelFullScreen();
		}
	}
}

var oBox = "global";
function openBox(el,str){
	oBox = str;
	if(str == "global"){
		els.globalBox.style.display = "flex";
		els.privateBox.style.display = "none";
		els.globalBtn.classList.add("active");
		els.privateBtn.classList.remove("active");
	}
	else if(str == "room"){
		els.globalBox.style.display = "none";
		els.privateBox.style.display = "flex";
		els.globalBtn.classList.remove("active");
		els.privateBtn.classList.add("active");
	}

}

ws.onopen = function(){
	var myName = localStorage.getItem("lidMultiGameSavedName") || prompt("enter your name (3-15 characters)");
	while(!(myName.length >= 3 && myName.length <= 15)){
		myName = prompt("enter your name (3-15 characters)");
	}
	localStorage.setItem("lidMultiGameSavedName",myName);
	sendMsg("changeName",myName);
}
ws.onmessage = function(msg){
	var msgData = JSON.parse(msg.data);
	switch(msgData.type){
		case "name":
			myId = msgData.content;
			break;
		case "console":
			console.log(msgData.content);
			break;
		case "alert":
			myAlert(msgData.content.heading,msgData.content.msg);
			break;
		case "games":
			var modesSelect = document.getElementById("modesSelect");
			for(var i=0;i<msgData.content.length;i++){
				modesSelect.insertAdjacentHTML("beforeend",'<option value="'+msgData.content[i]+'">'+msgData.content[i]+'</option>');
			}
			serverGames = msgData.content;
			break;
		case "roomsInfo":
			if(msgData.content.type === "allRooms"){
				var rooms = msgData.content.rooms;
				var roomBoxes = document.getElementsByClassName("roomBox");
				for(var i=0;i<rooms.length;i++){
					if(roomBoxes[i]){
						roomBoxes[i].childNodes[2].innerHTML = rooms[i].playersLength+"/"+rooms[i].maxCapacity;
						roomBoxes[i].childNodes[1].childNodes[0].innerHTML = "Name: "+rooms[i].name;
						roomBoxes[i].childNodes[1].childNodes[1].innerHTML = "Mode: "+rooms[i].mode;
					}
					else{
						var html = '<div class="roomBox" onclick="selectRoom(this);"><span class="number">'+(i+1)+'</span><div class="info"><span>Name: '+rooms[i].name+'</span><span>Mode: '+rooms[i].mode+'</span></div><span class="pCount">'+rooms[i].playersLength+'/'+rooms[i].maxCapacity+'</span></div>';
						els.roomsBox.insertAdjacentHTML("beforeend",html);
						var roomBox = document.getElementsByClassName("roomBox");
					}
				}
				for(var i=rooms.length;i<roomBoxes.length;i++){
					roomBoxes[i].parentNode.removeChild(roomBoxes[i]);
					i--;
				}
			}else if(msgData.content.type === "yourRoom"){
				var members = msgData.content.members;
				var memberBoxes = document.getElementsByClassName("member");
				for(var i=0;i<msgData.content.maxCapacity;i++){
					var memberClass = "unready";
					var id;
					var teamClass = "teamColor";
					if(members[i]){
						if(members[i].status == 1){memberClass="ready";}
						else if(members[i].status == 2){memberClass="battling";}
						id=members[i].id;
						teamClass = "teamColor team"+(members[i].team+1);
					}
					else{memberClass=id="";}
					if(memberBoxes[i]){
						memberBoxes[i].children[1].children[0].innerHTML = id;
						memberBoxes[i].children[1].children[1].className = teamClass;
						memberBoxes[i].className = "member "+memberClass;
					}
					else{
						var html = '<div class="member '+memberClass+'"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="/><div class="content"><p>'+id+'</p><div class="'+teamClass+'"></div></div></div>';
						els.membersBox.insertAdjacentHTML("beforeend",html);
					}
				}
				for(var i=msgData.content.maxCapacity;i<memberBoxes.length;i++){
					memberBoxes[i].parentNode.removeChild(memberBoxes[i]);
					i--;
				}
			}
			break;
		case "goToRoom":
			els.lobby.style.display = "flex";
			els.roomsList.style.display = "none";
			els.myRoomBox.style.display = "flex";
			els.gameBox.style.display = "none";
		break;
		case "backToRoom":
			setTimeout(function(){
				els.lobby.style.display = "flex";
				els.roomsList.style.display = "none";
				els.myRoomBox.style.display = "flex";
				els.gameBox.style.display = "none";
				cancelAnimationFrame(animate);
			},1000);
			break;
		case "goToGame":
			els.lobby.style.display = "none";
			els.roomsList.style.display = "none";
			els.myRoomBox.style.display="none";
			els.gameBox.style.display = "block";
			lastGame = msgData.content;
			switch(lastGame){
				case "Tic Tac Toe":xoBoxResize();break;
				case "Castles":castlesBoxResize();break;
				case "Chess":chessBoxResize();break;
			}
			requestAnimationFrame(animate);
			break;
		case "backToRooms":
			els.lobby.style.display = "flex";
			els.roomsList.style.display = "flex";
			els.myRoomBox.style.display = "none";
			els.gameBox.style.display = "none";
			break;
		case "globalMessage":
			var scroll = Math.floor(els.globalBox.scrollTop+els.globalBox.clientHeight)==els.globalBox.scrollHeight;
			var html = '<div class="msgBox '+msgData.content.classes+'"><div class="msg"><h3 class="msgSender">'+msgData.content.sender+'</h3><p class="msgContent">'+msgData.content.content+'</p></div></div>';
			els.globalBox.insertAdjacentHTML("beforeend",html);
			if(scroll){els.globalBox.scrollTo(0,els.globalBox.scrollHeight);}
			break;
		case "roomMessage":
			var scroll = Math.floor(els.privateBox.scrollTop+els.privateBox.clientHeight)==els.privateBox.scrollHeight;
			var html = '<div class="msgBox '+msgData.content.classes+'"><div class="msg"><h3 class="msgSender">'+msgData.content.sender+'</h3><p class="msgContent">'+msgData.content.content+'</p></div></div>';
			els.privateBox.insertAdjacentHTML("beforeend",html);
			if(scroll){els.privateBox.scrollTo(0,els.privateBox.scrollHeight);}
			break;
		case "xoInfo":
			for(var i=0;i<msgData.content.gameData.length;i++){
				xoInfo.gameData[i] = msgData.content.gameData[i];
			}
			xoInfo.isClientTurn = msgData.content.isClientTurn;
			xoInfo.turn = msgData.content.turn;
			break;
		case "castlesInfo":
			castlesInfo.castles = msgData.content.castles;
			castlesInfo.armies = msgData.content.armies;
			castlesInfo.myIndex = msgData.content.myIndex;
			break;
		case "chessInfo":
			chessInfo.board = msgData.content;
			var pieces = {
				"ChessKing":ChessKing,
				"ChessQueen":ChessQueen,
				"ChessRook":ChessRook,
				"ChessBishop":ChessBishop,
				"ChessKnight":ChessKnight,
				"ChessPawn":ChessPawn
			};
			var cells = [];
			for(var i=0;i<chessInfo.board.cells.length;i++){
				if(!chessInfo.board.cells[i]){cells.push(undefined);continue;}
				var Class = pieces[chessInfo.board.cells[i].className];
				var piece = new Class(chessInfo.board.cells[i].player);
				piece.movesCount = chessInfo.board.cells[i].movesCount;
				piece.enPassantTime = chessInfo.board.cells[i].enPassantTime;
				piece.enPassantFile = chessInfo.board.cells[i].enPassantFile;
				cells.push(piece);
			}
			chessInfo.boardInstance = new ChessBoard(cells);
			chessInfo.boardInstance.time = chessInfo.board.time;
			chessInfo.selectedPiece = undefined;
			chessInfo.shadowsPos = [];
			chessInfo.kingChecked = chessInfo.boardInstance.isKingChecked(chessInfo.board.turn);
			break;
		default:
		myAlert("new: "+msgData.type);
	}
	
}
var lastFrameTime = 0;
function animate(time){
	var dt = time - lastFrameTime;
	lastFrameTime = time;
	var fps = Math.round(1000/dt);
	switch(lastGame){
		case "Tic Tac Toe":
			var box = xoInfo.box;
			ctx.clearRect(0,0,c.width,c.height);
			ctx.fillStyle = ctx.strokeStyle = "#fff";
			ctx.lineWidth = xoInfo.lineWidth;
			for(var i=1;i<3;i++){
				ctx.beginPath();
				ctx.moveTo(box.x+i*box.size/3,box.y);
				ctx.lineTo(box.x+i*box.size/3,box.y+box.size);
				ctx.closePath();
				ctx.stroke();
			}
			for(var j=1;j<3;j++){
				ctx.beginPath();
				ctx.moveTo(box.x,box.y+j*box.size/3);
				ctx.lineTo(box.x+box.size,box.y+j*box.size/3);
				ctx.closePath();
				ctx.stroke();
			}
			ctx.font = (box.size/10)+"px Arial";
			ctx.textAlign = "center";
			ctx.textBaseline = "bottom";
			if(xoInfo.isClientTurn){
				ctx.fillText("your turn",window.innerWidth/2,xoInfo.box.y-20);
			}else{
				ctx.fillText(xoInfo.turn+"'s turn",window.innerWidth/2,xoInfo.box.y-20);
			}
			ctx.font = (box.size/6)+"px Arial";
			ctx.textBaseline = "middle";
			for(var i=0;i<xoInfo.gameData.length;i++){
				var text = xoInfo.gameData[i];
				if(text === -1){text = "";}
				else if(text === 0){text = "×";}
				else if(text === 1){text = "o";}
				var x = i % 3;
				var y = Math.floor(i / 3);
				ctx.fillText(text,xoInfo.box.x + x*xoInfo.box.size/3+xoInfo.box.size/6,xoInfo.box.y + y*xoInfo.box.size/3+xoInfo.box.size/6);
			}
			requestAnimationFrame(animate);
			break;
		case "Castles":
			var box = castlesInfo.box;
			ctx.clearRect(0,0,c.width,c.height);
		//	ctx.strokeRect(box.x,box.y,box.width,box.height);
			ctx.save();
			ctx.translate(box.x,box.y);
			ctx.strokeStyle = "#aaa";
			ctx.lineWidth = box.width/15;
			for(var i=0;i<castlesInfo.castles.length;i++){
				var castle = castlesInfo.castles[i];
				for(var j=0;j<castle.nearCastles.length;j++){
					var nearCastle = castlesInfo.castles[castlesInfo.castles[i].nearCastles[j]];
					ctx.beginPath();
					ctx.moveTo(castle.pos.x*box.width,castle.pos.y*box.height);
					ctx.lineTo(nearCastle.pos.x*box.width,nearCastle.pos.y*box.height);
					ctx.stroke();
					ctx.closePath();
				}
			}
			for(var i=0;i<castlesInfo.castles.length;i++){
				var castle = castlesInfo.castles[i];
				for(var j=0;j<castle.nearCastles.length;j++){
					var nearCastle = castlesInfo.castles[castlesInfo.castles[i].nearCastles[j]];
					var angle = calculateAngle(new Vec2(castle.pos.x,castle.pos.y*1.5),new Vec2(nearCastle.pos.x,nearCastle.pos.y*1.5));
					var distance = calculateDistance(new Vec2(castle.pos.x,castle.pos.y*1.5),new Vec2(nearCastle.pos.x,nearCastle.pos.y*1.5));
					ctx.translate(castle.pos.x*box.width,castle.pos.y*box.height);
					ctx.rotate(angle);
					ctx.beginPath();
					ctx.moveTo(0,0);
					ctx.lineTo((distance/2)*box.width,0);
					ctx.strokeStyle = castlesInfo.castlesColor[castle.player];
					if(castle.team != -1){
						ctx.globalAlpha = 0.5;
						ctx.stroke();
						ctx.globalAlpha = 1.0;
					}
					ctx.closePath();
					if(castle.player == castlesInfo.myIndex){
					drawArrow(0.05*box.width,0,0.10*box.width,0,box.width/50,box.width/500,"rgba(255,255,255,0.9)");
					}
					ctx.rotate(-angle);
					ctx.translate(-castle.pos.x*box.width,-castle.pos.y*box.height);
				}
			}
			for(var i=0;i<castlesInfo.armies.length;i++){
				var army = castlesInfo.armies[i];
				ctx.beginPath();
				ctx.arc(army.pos.x*box.width,army.pos.y*box.height,0.1*box.width*(army.value/18),0,2*Math.PI);
				ctx.fillStyle = castlesInfo.castlesColor[army.player] || "#888";
				ctx.fill();
				ctx.closePath();
				var angle = calculateAngle(new Vec2(army.originCastle.pos.x,army.originCastle.pos.y*1.5),new Vec2(army.destinationCastle.pos.x,army.destinationCastle.pos.y*1.5));
				//castlesInfo.armies[i].pos.x += 0.0001*dt*Math.cos(angle);
				//castlesInfo.armies[i].pos.y += 0.0001*dt*Math.sin(angle);
			}
			ctx.textAlign = "center";
			ctx.textBaseline = "middle";
			for(var i=0;i<castlesInfo.castles.length;i++){
				var castle = castlesInfo.castles[i];
				ctx.beginPath();
				ctx.shadowBlur = box.width/30;
				ctx.shdowColor = "rgba(0,0,0,1)";
				drawRegPolygon(castle.pos.x*box.width,castle.pos.y*box.height,0.1*box.width*(castle.value/18),6);
				ctx.fillStyle = castlesInfo.castlesColor[castle.player] || "#888";
				ctx.fill();
				ctx.closePath();
				ctx.shadowBlur = 0;
				ctx.shdowColor = "rgba(0,0,0,0)";
				ctx.font = ((box.width/7)*(castle.value/18))+"px Arial";
				ctx.globalCompositeOperation = "difference";
				ctx.fillStyle = "#fff";
				var txt = "";
				if(castle.team!=-1){txt = (castle.team+1).toString();}
				ctx.fillText(txt,castle.pos.x*box.width,castle.pos.y*box.height);
				ctx.globalCompositeOperation = "source-over";
			}
			ctx.restore();
			requestAnimationFrame(animate);
			break;
		case "Chess":
			var box = chessInfo.box;
			ctx.clearRect(0,0,c.width,c.height);
			ctx.save();
			if(chessInfo.board.yourTurn==1){
				ctx.translate(c.width/2,c.height/2);
				ctx.rotate(Math.PI);
				ctx.translate(-c.width/2,-c.height/2);
			}
			ctx.translate(box.x,box.y);
			for(var i=0;i<64;i++){
				var x = i%chessInfo.board.width;
				var y = Math.floor(i/chessInfo.board.width);
				ctx.fillStyle = chessInfo.chessColors[(x+(y%2))%2];
				ctx.fillRect(x*box.width/chessInfo.board.width,y*box.height/chessInfo.board.height,box.width/chessInfo.board.width,box.height/chessInfo.board.height);
			}
			if(chessInfo.kingChecked){
				ctx.fillStyle = "rgba(255,50,50,0.7)";
				ctx.fillRect(chessInfo.kingChecked.x*box.width/chessInfo.board.width,chessInfo.kingChecked.y*box.height/chessInfo.board.height,box.width/chessInfo.board.width,box.height/chessInfo.board.height);

			}
			if(chessInfo.selectedPiece){
				ctx.fillStyle = "rgba(50,255,50,0.5)";
				ctx.fillRect(chessInfo.selectedPiece.x*box.width/chessInfo.board.width,chessInfo.selectedPiece.y*box.height/chessInfo.board.height,box.width/chessInfo.board.width,box.height/chessInfo.board.height);
			}
			for(var i=0;i<chessInfo.board.cells.length;i++){
				var cell = chessInfo.board.cells[i];
				if(!cell){continue;}
				var x = i%chessInfo.board.width;
				var y = Math.floor(i/chessInfo.board.width);
				if(chessInfo.board.yourTurn==1){
					ctx.translate(x*chessInfo.box.width/chessInfo.board.width+(chessInfo.box.width/chessInfo.board.width)/2,y*chessInfo.box.height/chessInfo.board.height+(chessInfo.box.height/chessInfo.board.height)/2);
					ctx.rotate(Math.PI);
					ctx.translate(-x*chessInfo.box.width/chessInfo.board.width-(chessInfo.box.width/chessInfo.board.width)/2,-y*chessInfo.box.height/chessInfo.board.height-(chessInfo.box.height/chessInfo.board.height)/2);
				}
				var classIndex = 0;
				for(var j=0;j<chessInfo.chessClasses.length;j++){
					if(cell.className === chessInfo.chessClasses[j]){
						classIndex = j;
					}
				}
				var img = chessInfo.imgPieces[classIndex*2+cell.player];
				if(chessInfo.img){
					ctx.drawImage(img,x*box.width/chessInfo.board.width,y*box.height/chessInfo.board.height,box.width/chessInfo.board.width,box.height/chessInfo.board.height);
				}else{
					ctx.textAlign = "center";
					ctx.textBaseline = "middle";
					ctx.font = (box.width*0.12)+"px Arial";
					ctx.fillStyle = cell.player==1?"black":"white";
					ctx.fillText(chessInfo.textPieces[classIndex*2+cell.player],x*box.width/chessInfo.board.width+(box.width/chessInfo.board.width)/2,y*box.height/chessInfo.board.height+(box.height/chessInfo.board.height)/2);
				}
				if(chessInfo.board.yourTurn==1){
					ctx.translate(x*chessInfo.box.width/chessInfo.board.width+(chessInfo.box.width/chessInfo.board.width)/2,y*chessInfo.box.height/chessInfo.board.height+(chessInfo.box.height/chessInfo.board.height)/2);
					ctx.rotate(-Math.PI);
					ctx.translate(-x*chessInfo.box.width/chessInfo.board.width-(chessInfo.box.width/chessInfo.board.width)/2,-y*chessInfo.box.height/chessInfo.board.height-(chessInfo.box.height/chessInfo.board.height)/2);
				}
			}
			for(var i=0;i<chessInfo.shadowsPos.length;i++){
				var x = chessInfo.shadowsPos[i].x;
				var y = chessInfo.shadowsPos[i].y;
				ctx.fillStyle = "rgba(50,180,50,0.8)";
				ctx.beginPath();
				ctx.arc(x*chessInfo.box.width/chessInfo.board.width+(chessInfo.box.width/chessInfo.board.width)/2,y*chessInfo.box.height/chessInfo.board.height+(chessInfo.box.height/chessInfo.board.height)/2,(chessInfo.box.height/chessInfo.board.height)/6,0,2*Math.PI);
				ctx.closePath();
				ctx.fill();
			}
			ctx.restore();
			requestAnimationFrame(animate);
			break;
	}
}
function drawArrow(fromx, fromy, tox, toy, arrowWidth,headlen, color){
	var angle = Math.atan2(toy-fromy,tox-fromx);
	ctx.save();
	ctx.strokeStyle = color;
	ctx.beginPath();
	ctx.moveTo(fromx, fromy);
	ctx.lineTo(tox, toy);
	ctx.lineWidth = arrowWidth;
	ctx.stroke();
	ctx.beginPath();
	ctx.moveTo(tox, toy);
	ctx.lineTo(tox-headlen*Math.cos(angle-Math.PI/7),toy-headlen*Math.sin(angle-Math.PI/7));
	ctx.lineTo(tox-headlen*Math.cos(angle+Math.PI/7),toy-headlen*Math.sin(angle+Math.PI/7));
	ctx.lineTo(tox, toy);
	ctx.lineTo(tox-headlen*Math.cos(angle-Math.PI/7),toy-headlen*Math.sin(angle-Math.PI/7));
	ctx.stroke();
	ctx.restore();
}
function calculateAngle(v1,v2){
	var dx = v2.x - v1.x;
	var dy = v2.y - v1.y;
	return Math.atan2(dy,dx);
}
function calculateDistance(v1,v2){
	var dx = v2.x - v1.x;
	var dy = v2.y - v1.y;
	return Math.sqrt(dx*dx+dy*dy);
}
function xoBoxResize(){
	xoInfo.box.size = Math.min(window.innerWidth*0.85,(window.innerHeight-100)*0.85);
	xoInfo.box.x = window.innerWidth/2 - xoInfo.box.size/2;
	xoInfo.box.y = window.innerHeight/2 - xoInfo.box.size/2;
	xoInfo.lineWidth = xoInfo.box.size*0.05;
}
function castlesBoxResize(){
	var ar = window.innerWidth/window.innerHeight;
	var v;
	if(ar>=0.666666667){
		v = {w:window.innerHeight*0.666666667,h:window.innerHeight};
	}else{
		v = {w:window.innerWidth,h:window.innerWidth*1.5};
	}
	castlesInfo.box.x = window.innerWidth*0.5 - v.w*0.5;
	castlesInfo.box.y = window.innerHeight*0.5 - v.h*0.5;
	castlesInfo.box.width = v.w;
	castlesInfo.box.height = v.h;
}
function chessBoxResize(){
	var size = Math.min(window.innerWidth,window.innerHeight);
	chessInfo.box.x = window.innerWidth*0.5-size*0.5;
	chessInfo.box.y = window.innerHeight*0.5-size*0.5;
	chessInfo.box.width = chessInfo.box.height = size;
}
function changeCssVar(varName,val){
	document.documentElement.style.setProperty(varName, val);
}
window.addEventListener("load",function(){
	changeCssVar("--vh",(window.innerHeight * 0.01)+"px");
	c.width = window.innerWidth;
	c.height = window.innerHeight;
});
window.addEventListener("resize",function(){
	changeCssVar("--vh",(window.innerHeight * 0.01)+"px");
	c.width = window.innerWidth;
	c.height = window.innerHeight;
	switch(lastGame){
		case "Tic Tac Toe":xoBoxResize();break;
		case "Castles":castlesBoxResize();break;
		case "Chess":chessBoxResize();break;
	}
});
function xoPlay(cellIndex){
	sendMsg("xoPlay",cellIndex);
}
function joinRoom(num){
	if(selectedRm != -1){
		sendMsg("joinRoom",num);
	}else{
		myAlert("Alert","please select a room first");
	}
}
function leaveRoom(){
	sendMsg("leaveRoom");
}
function createRoom(){
	var userRoomName = document.getElementById("userRoomName");
	var data = els.alert1.getData();
	if(data.roomName.length>0 && data.roomName.length<=15){
		userRoomName.className = "";
		userRoomName.value = "";
		els.alert1.style.display = "none";
		blackLayer.style.display = "none";
		sendMsg("createRoom",data);
	}else{
		userRoomName.value = "";
		userRoomName.className = "red";
	}
}
function changeReady(){
	sendMsg("ready");
}
function drawRegPolygon(x,y,radius,sides){
	ctx.beginPath();
	ctx.moveTo(x + radius * Math.cos(0),y + radius * Math.sin(0));          
	for(var i=1;i<=sides;i++){
		ctx.lineTo(x + radius * Math.cos(i * 2 * Math.PI / sides),y + radius * Math.sin(i * 2 * Math.PI / sides));
	}
}
function selectRoom(el){
	var roomBox = document.getElementsByClassName("roomBox");
	for(var i=0;i<roomBox.length;i++){
		if(roomBox[i] === el){
			selectedRm = i;
			roomBox[i].className = "roomBox selected";
		}else{
			roomBox[i].className = "roomBox";
		}
		
	}
}
function sendMsg(type,content,more){
	var msg = {
		type:type,
		content:content
	}
	for(var el in more){
		msg[el] = more[el];
	}
	ws.send(JSON.stringify(msg));
}
c.addEventListener("click",function(e){
	var click = new Vec2(e.clientX,e.clientY);
	switch(lastGame){
		case "Tic Tac Toe":
			xoClick(click);
			break;
		case "Castles":
			castlesClick(click);
			break;
		case "Chess":
			chessClick(click);
			break;
		default:alert("new: "+lastGame);
	}
});
function xoClick(v){
	var x = Math.floor((v.x - xoInfo.box.x)*3/xoInfo.box.size);
	var y = Math.floor((v.y - xoInfo.box.y)*3/xoInfo.box.size);
	var ci = y*3+x;
	if(ci>=0 && ci<=8){
		xoPlay(ci);
	}
}
function castlesClick(v){
	var min = undefined;
	var index = 0;
	for(var i=0;i<castlesInfo.castles.length;i++){
		var dx = ((v.x-castlesInfo.box.x)/castlesInfo.box.width) - castlesInfo.castles[i].pos.x;
		var dy = ((v.y-castlesInfo.box.y)/castlesInfo.box.height)*1.5 - castlesInfo.castles[i].pos.y*1.5;
		var dis = Math.sqrt(dx*dx+dy*dy);
		if(min === undefined || min>dis){
			min = dis;
			index = i;
		}
	}
	if(min<0.15){
		var castle = castlesInfo.castles[index];
		var tdx = ((v.x-castlesInfo.box.x)/castlesInfo.box.width) - castle.pos.x;
		var tdy = ((v.y-castlesInfo.box.y)/castlesInfo.box.height)*1.5 - castle.pos.y*1.5;
		var touchAngle = Math.atan2(tdy,tdx);
		var difAngle = null;
		var arrayIndex = 0;
		for(var i=0;i<castlesInfo.castles[index].nearCastles.length;i++){
			var nearCastle = castlesInfo.castles[castlesInfo.castles[index].nearCastles[i]];
			var cdx = nearCastle.pos.x - castle.pos.x;
			var cdy = nearCastle.pos.y*1.5 - castle.pos.y*1.5;
			var exactAngle = Math.atan2(cdy,cdx);
			var dif = Math.abs(touchAngle - exactAngle);
			if(difAngle === null || difAngle>dif){
				difAngle = dif;
				arrayIndex = i;
			}
		}
		var destinationIndex = castle.nearCastles[arrayIndex];
		if(Math.abs(difAngle*180/Math.PI) <= 20){
			sendMsg("castlesPlay",{originCastle:index,destinationCastle:destinationIndex});
		}
	}
}
function chessClick(v){
	v.x -= chessInfo.box.x;
	v.y -= chessInfo.box.y;
	var boardX = Math.floor(v.x*chessInfo.board.width/chessInfo.box.width);
	var boardY = Math.floor(v.y*chessInfo.board.height/chessInfo.box.height);
	if(chessInfo.board.yourTurn==1){
		boardX = (chessInfo.board.width-1)-boardX;
		boardY = (chessInfo.board.height-1)-boardY;
	}
	if(boardX>=0 && boardX<chessInfo.board.width && boardY>=0 && boardY<chessInfo.board.height){
		if(chessInfo.board.turn === chessInfo.board.yourTurn){
			if(chessInfo.selectedPiece){
				if(chessInfo.board.cells[boardY*chessInfo.board.width+boardX] && chessInfo.board.cells[boardY*chessInfo.board.width+boardX].player===chessInfo.board.yourTurn){
					chessInfo.selectedPiece = {x:boardX,y:boardY};
					chessInfo.shadowsPos = chessInfo.boardInstance.cells[boardY*chessInfo.board.width+boardX].getLegalMoves(chessInfo.boardInstance,{x:boardX,y:boardY});

				}else{
					var done = false;
					for(var i=0;i<chessInfo.shadowsPos.length;i++){
						if(chessInfo.shadowsPos[i].x  === boardX && chessInfo.shadowsPos[i].y  === boardY){
							if(!(chessInfo.boardInstance.cells[chessInfo.selectedPiece.y*chessInfo.board.width+chessInfo.selectedPiece.x] instanceof ChessPawn && ((chessInfo.board.yourTurn == 0 && boardY==0) || (chessInfo.board.yourTurn == 1 && boardY==7)))){
								chessPlay({x:chessInfo.selectedPiece.x,y:chessInfo.selectedPiece.y},{x:chessInfo.shadowsPos[i].x,y:chessInfo.shadowsPos[i].y});
								done = true;
								break;
							}else{
								myAlert("pawn promotion",'choose a piece:<br>'+
								'<span class="chessPiece" onclick="chessPlay({x:chessInfo.selectedPiece.x,y:chessInfo.selectedPiece.y},{x:chessInfo.shadowsPos['+i+'].x,y:chessInfo.shadowsPos['+i+'].y,promotion:0});els.alert2.hide();">'+chessInfo.textPieces[8+chessInfo.board.yourTurn]+'</span>'+
								'<span class="chessPiece" onclick="chessPlay({x:chessInfo.selectedPiece.x,y:chessInfo.selectedPiece.y},{x:chessInfo.shadowsPos['+i+'].x,y:chessInfo.shadowsPos['+i+'].y,promotion:1});els.alert2.hide();">'+chessInfo.textPieces[6+chessInfo.board.yourTurn]+'</span>'+
								'<span class="chessPiece" onclick="chessPlay({x:chessInfo.selectedPiece.x,y:chessInfo.selectedPiece.y},{x:chessInfo.shadowsPos['+i+'].x,y:chessInfo.shadowsPos['+i+'].y,promotion:2});els.alert2.hide();">'+chessInfo.textPieces[4+chessInfo.board.yourTurn]+'</span>'+
								'<span class="chessPiece" onclick="chessPlay({x:chessInfo.selectedPiece.x,y:chessInfo.selectedPiece.y},{x:chessInfo.shadowsPos['+i+'].x,y:chessInfo.shadowsPos['+i+'].y,promotion:3});els.alert2.hide();">'+chessInfo.textPieces[2+chessInfo.board.yourTurn]+'</span>');
								done = true;
								break;
							}
						}
					}
					if(!done){
						chessInfo.selectedPiece = undefined;
						chessInfo.shadowsPos = [];
					}
				}
			}else{
				if(chessInfo.board.cells[boardY*chessInfo.board.width+boardX] && chessInfo.board.cells[boardY*chessInfo.board.width+boardX].player===chessInfo.board.yourTurn){
					chessInfo.selectedPiece = {x:boardX,y:boardY};
					chessInfo.shadowsPos = chessInfo.boardInstance.cells[boardY*chessInfo.board.width+boardX].getLegalMoves(chessInfo.boardInstance,{x:boardX,y:boardY});
				}
			}
		}
	}
}
function chessPlay(a,b){
	sendMsg("chessPlay",{oldPos:a,newPos:b});
}
function myAlert(heading,text){
	if(!heading){heading = "Alert";}
	blackLayer.style.display = "block";
	els.alert2.style.display = "flex";
/*	text = text.split("\"+"n");
	text = text.join("<br>");*/
	els.alert2.children[0].innerHTML = heading;
	els.alert2.children[1].innerHTML = text;
}
function myPrompt(question,callback,placeholder){
	var p = document.getElementById("prompt");
	blackLayer.style.display = "block";
	p.style.display = "flex";
	if(!placeholder){placeholder="";}
	p.children[0].innerHTML = question;
	p.children[2].myPromptCallback = callback;
}
function Vec2(x,y){
	this.x = x;
	this.y = y;
}

class ChessBoard{
	constructor(cells){
		this.width = 8;
		this.height = 8;
		this.time = 0;
		this.turn = 0;
		if(cells){
			this.cells = cells;
		}else{
			this.cells = new Array(64);
			this.defaultPos();
		}
	}
	play(oldPos,newPos){/*without any checks*/
		var oldCell = this.cells[oldPos.y*this.width+oldPos.x];
		if(oldCell instanceof ChessPawn && oldCell.movesCount===0){
			for(var i=0;i<this.cells.length;i++){
				if(this.cells[i] instanceof ChessPawn && this.cells[i].player != oldCell.player){
					this.cells[i].enPassantTime = this.time+1;
					this.cells[i].enPassantFile = oldPos.x;
				}
			}
		}
		if(newPos.enPassant){
			var removeCell = [{x:0,y:-1}];
			oldCell.multip(removeCell);
			this.cells[(newPos.y+removeCell[0].y)*this.width+(newPos.x+removeCell[0].x)] = undefined;
		}
		if(newPos.castling){
			if(newPos.castling.x==3){
				this.cells[newPos.castling.y*this.width+newPos.castling.x] = this.cells[oldPos.y*this.width].clone();
				this.cells[oldPos.y*this.width] = undefined;
			}
			else if(newPos.castling.x==5){
				this.cells[newPos.castling.y*this.width+newPos.castling.x] = this.cells[oldPos.y*this.width+7].clone();
				this.cells[oldPos.y*this.width+7] = undefined;
			}
		}
		oldCell.movesCount++;
		this.time++;
		this.cells[newPos.y*this.width+newPos.x] = oldCell.clone();
		if(this.cells[newPos.y*this.width+newPos.x] instanceof ChessPawn && this.cells[newPos.y*this.width+newPos.x].player == 0 && newPos.y == 0 && newPos.promotion>=0 && newPos.promotion<=3){
			var options = [ChessKnight,ChessBishop,ChessRook,ChessQueen];
			this.cells[newPos.y*this.width+newPos.x] = new options[newPos.promotion](0);
		}
		if(this.cells[newPos.y*this.width+newPos.x] instanceof ChessPawn && this.cells[newPos.y*this.width+newPos.x].player == 1 && newPos.y == 7 && newPos.promotion>=0 && newPos.promotion<=3){
			var options = [ChessKnight,ChessBishop,ChessRook,ChessQueen];
			this.cells[newPos.y*this.width+newPos.x] = new options[newPos.promotion](1);
		}
		this.cells[oldPos.y*this.width+oldPos.x] = undefined;
	}
	clone(){
		var clonedCells = new Array(64);
		for(var i=0;i<this.cells.length;i++){
			if(!this.cells[i]){continue;}
			clonedCells[i] = this.cells[i].clone();
		}
		var newBoard = new ChessBoard(clonedCells);
		newBoard.time = this.time;
		newBoard.turn = this.turn;
		return newBoard;
	}
	isKingChecked(player){
		var playerKing;
		var kingPos;
		for(var i=0;i<this.cells.length;i++){
			if(!this.cells[i]){continue;}
			if(this.cells[i].player === player && this.cells[i] instanceof ChessKing){
				playerKing = this.cells[i];
				kingPos = {x:i%this.width,y:Math.floor(i/this.width)};
			}
		}
		if(!playerKing){return true;}
		for(var i=0;i<this.cells.length;i++){
			if(!this.cells[i]){continue;}
			if(this.cells[i].player != player){
				var cellPos = {x:i%this.width,y:Math.floor(i/this.width)};
				var cellThreats = this.cells[i].getThreats(this,cellPos);
				for(var j=0;j<cellThreats.length;j++){
					if(cellThreats[j].x === kingPos.x && cellThreats[j].y === kingPos.y){
						return kingPos;
					}
				}
			}
		}
		return false;
	}
	defaultPos(){
		for(var i=0;i<this.cells.length;i++){
			this.cells[i] = undefined;
		}
		this.cells[0] = this.cells[7] = new ChessRook(1);
		this.cells[1] = this.cells[6] = new ChessKnight(1);
		this.cells[2] = this.cells[5] = new ChessBishop(1);
		this.cells[3] = new ChessQueen(1);
		this.cells[4] = new ChessKing(1);

		for(var i=8;i<16;i++){
			this.cells[i] = new ChessPawn(1);
		}
		
		for(var i=48;i<56;i++){
			this.cells[i] = new ChessPawn(0);
		}
		this.cells[56] = this.cells[63] = new ChessRook(0);
		this.cells[57] = this.cells[62] = new ChessKnight(0);
		this.cells[58] = this.cells[61] = new ChessBishop(0);
		this.cells[59] = new ChessQueen(0);
		this.cells[60] = new ChessKing(0);
	}
}
class ChessPieces{
	constructor(playerIndex){
		this.movesCount = 0;
		this.moves = [];
		this.infMoves = [];
		this.player = playerIndex;
	}
	checkInBoard(board,newPos){
		return newPos.x>=0 && newPos.y>=0 && newPos.x<board.width && newPos.y<board.height;
	}
	getPseudoMoves(board,pos){
		var posMoves = [];
		for(var i=0;i<this.moves.length;i++){
			var newPos = {x:pos.x+this.moves[i].x,y:pos.y+this.moves[i].y};
			var newCell = board.cells[newPos.y*board.width+newPos.x];
			var sameTeam = false;
			if(newCell){sameTeam = newCell.player == this.player;}
			if(this.checkInBoard(board,newPos) && !sameTeam){
				posMoves.push(newPos);
			}
		}
		for(var i=0;i<this.infMoves.length;i++){
			var newPos = {x:pos.x+this.infMoves[i].x,y:pos.y+this.infMoves[i].y};
			var newCell = board.cells[newPos.y*board.width+newPos.x];
			var sameTeam = true;
			if(newCell){sameTeam = newCell.player == board.cells[pos.y*board.width+pos.x].player;}
			while(this.checkInBoard(board,newPos) && (!newCell || !sameTeam)){
				posMoves.push({x:newPos.x,y:newPos.y});
				newPos.x += this.infMoves[i].x;
				newPos.y += this.infMoves[i].y;
				if(newCell && !sameTeam){break;}
				newCell = board.cells[newPos.y*board.width+newPos.x];
				sameTeam = true;
				if(newCell){sameTeam = newCell.player == board.cells[pos.y*board.width+pos.x].player;}
			}
		}
		return posMoves;
	}
	getLegalMoves(board,pos){
		var pseudoMoves = this.getPseudoMoves(board,pos);
		for(var i=0;i<pseudoMoves.length;i++){
			var futureBoard = board.clone();
			futureBoard.play(pos,pseudoMoves[i]);
			if(futureBoard.isKingChecked(this.player)){
				pseudoMoves.splice(i,1);
				i--;
			}
		}
		return pseudoMoves;
	}
	getThreats(board,pos){
		var threats = [];
		for(var i=0;i<this.moves.length;i++){
			var newPos = {x:this.moves[i].x+pos.x,y:this.moves[i].y+pos.y};
			if(this.checkInBoard(board,newPos)){
				threats.push(newPos);
			}
		}
		for(var i=0;i<this.infMoves.length;i++){
			var newPos = {x:pos.x,y:pos.y};
			var newCell = board.cells[newPos.y*board.width+newPos.x];
			do{
				newPos.x += this.infMoves[i].x;
				newPos.y += this.infMoves[i].y;
				newCell = board.cells[newPos.y*board.width+newPos.x];
				if(this.checkInBoard(board,newPos)){threats.push({x:newPos.x,y:newPos.y})};
			}while(!newCell && this.checkInBoard(board,newPos));
		}
		return threats;
	}
	multip(movesArray){
		var chessMultip = [{x:1,y:-1},{x:1,y:1}];
		var v = chessMultip[this.player];
		for(var i=0;i<movesArray.length;i++){
			movesArray[i].x *= v.x;
			movesArray[i].y *= v.y;
		}
	}
}
class ChessBishop extends ChessPieces{
	constructor(playerIndex){
		super(playerIndex);
		this.symbol = "B";
		this.infMoves = [{x:-1,y:-1},{x:-1,y:1},{x:1,y:-1},{x:1,y:1}];
		this.multip(this.infMoves);
	}
	clone(){
		var newPiece = new ChessBishop(this.player);
		newPiece.movesCount = this.movesCount;
		return newPiece;
	}
}
class ChessRook extends ChessPieces{
	constructor(playerIndex){
		super(playerIndex);
		this.symbol = "R";
		this.infMoves = [{x:0,y:-1},{x:0,y:1},{x:-1,y:0},{x:1,y:0}];
		this.multip(this.infMoves);
	}
	clone(){
		var newPiece = new ChessRook(this.player);
		newPiece.movesCount = this.movesCount;
		return newPiece;
	}
}

class ChessKnight extends ChessPieces{
	constructor(playerIndex){
		super(playerIndex);
		this.symbol = "N";
		this.moves = [{x:1,y:2},{x:2,y:1},{x:-1,y:2},{x:-2,y:1},{x:-1,y:-2},{x:-2,y:-1},{x:2,y:-1},{x:1,y:-2}];
		this.multip(this.moves);
	}
	clone(){
		var newPiece = new ChessKnight(this.player);
		newPiece.movesCount = this.movesCount;
		return newPiece;
	}
}

class ChessQueen extends ChessPieces{
	constructor(playerIndex){
		super(playerIndex);
		this.symbol = "Q";
		this.infMoves = [{x:0,y:-1},{x:0,y:1},{x:-1,y:0},{x:1,y:0},{x:-1,y:-1},{x:-1,y:1},{x:1,y:-1},{x:1,y:1}];
		this.multip(this.infMoves);
	}
	clone(){
		var newPiece = new ChessQueen(this.player);
		newPiece.movesCount = this.movesCount;
		return newPiece;
	}
}

class ChessKing extends ChessPieces{
	constructor(playerIndex){
		super(playerIndex);
		this.symbol = "K";
		this.moves = [{x:0,y:-1},{x:0,y:1},{x:-1,y:0},{x:1,y:0},{x:-1,y:-1},{x:-1,y:1},{x:1,y:-1},{x:1,y:1}];
		this.multip(this.moves);
	}
	clone(){
		var newPiece = new ChessKing(this.player);
		newPiece.movesCount = this.movesCount;
		return newPiece;
	}
	getLegalMoves(board,pos){
		var pseudoMoves = this.getPseudoMoves(board,pos);
		for(var i=0;i<pseudoMoves.length;i++){
			var futureBoard = board.clone();
			futureBoard.play(pos,pseudoMoves[i]);
			if(futureBoard.isKingChecked(this.player)){
				pseudoMoves.splice(i,1);
				i--;
			}
		}
		/*check if there's castling*/
		if(this.movesCount==0 && !board.isKingChecked(this.player)){
			var rightRook = board.cells[pos.y*board.width+(pos.x+3)];
			var leftRook = board.cells[pos.y*board.width+(pos.x-4)];
			if(rightRook && rightRook.movesCount==0){
				var cellsBetweenPos = [{x:pos.x+1,y:pos.y},{x:pos.x+2,y:pos.y}];
				var areEmpty = true;
				for(var i=0;i<cellsBetweenPos.length;i++){
					if(board.cells[cellsBetweenPos[i].y*board.width+cellsBetweenPos[i].x]){
						areEmpty = false;
						break;
					}
				}
				var areAttacked = false;
				for(var i=0;i<board.cells.length;i++){
					if(board.cells[i] && board.cells[i].player != this.player){
						var threats = board.cells[i].getThreats(board,{x:i%board.width,y:Math.floor(i/board.width)});
						for(var j=0;j<threats.length;j++){
							if((threats[j].x==cellsBetweenPos[0].x&&threats[j].y==cellsBetweenPos[0].y)||(threats[j].x==cellsBetweenPos[1].x&&threats[j].y==cellsBetweenPos[1].y)){
								areAttacked = true;
								break;
							}
						}

					}
				}
				if(!areAttacked && areEmpty){
					pseudoMoves.push({x:cellsBetweenPos[1].x,y:cellsBetweenPos[1].y,castling:cellsBetweenPos[0]});
				}
			}
			if(leftRook && leftRook.movesCount==0){
				var cellsBetweenPos = [{x:pos.x-1,y:pos.y},{x:pos.x-2,y:pos.y},{x:pos.x-3,y:pos.y}];
				var areEmpty = true;
				for(var i=0;i<cellsBetweenPos.length;i++){
					if(board.cells[cellsBetweenPos[i].y*board.width+cellsBetweenPos[i].x]){
						areEmpty = false;
						break;
					}
				}
				var areAttacked = false;
				for(var i=0;i<board.cells.length;i++){
					if(board.cells[i] && board.cells[i].player != this.player){
						var threats = board.cells[i].getThreats(board,{x:i%board.width,y:Math.floor(i/board.width)});
						for(var j=0;j<threats.length;j++){
							if((threats[j].x==cellsBetweenPos[0].x&&threats[j].y==cellsBetweenPos[0].y)||(threats[j].x==cellsBetweenPos[1].x&&threats[j].y==cellsBetweenPos[1].y)){
								areAttacked = true;
								break;
							}
						}
					}
				}
				if(!areAttacked && areEmpty){
					pseudoMoves.push({x:cellsBetweenPos[1].x,y:cellsBetweenPos[1].y,castling:cellsBetweenPos[0]});
				}
			}
		}
		
		return pseudoMoves;
	}
}

class ChessPawn extends ChessPieces{
	constructor(playerIndex){
		super(playerIndex);
		this.symbol = "P";
		this.enPassantTime = 0;
		this.emptyMoves = [{x:0,y:1},{x:0,y:2}];
		this.moves = [{x:1,y:1},{x:-1,y:1}];
		this.multip(this.moves);
		this.multip(this.emptyMoves);
	}
	getPseudoMoves(board,pos){
		var posMoves = [];
		var newPos = {x:pos.x+this.emptyMoves[0].x,y:pos.y+this.emptyMoves[0].y};
		var newCell = board.cells[newPos.y*board.width+newPos.x];
		if(!newCell){
			posMoves.push(newPos);
		}
		if(this.movesCount === 0 && posMoves.length === 1){
			newPos = {x:pos.x+this.emptyMoves[1].x,y:pos.y+this.emptyMoves[1].y};
			newCell = board.cells[newPos.y*board.width+newPos.x];
			if(!newCell){
				posMoves.push(newPos);
			}
		}
		for(var i=0;i<this.moves.length;i++){
			newPos = {x:pos.x+this.moves[i].x,y:pos.y+this.moves[i].y};
			newCell = board.cells[newPos.y*board.width+newPos.x];
			var sameTeam = true;
			if(newCell){sameTeam = this.player === newCell.player;}
			if(newCell && !sameTeam && this.checkInBoard(board,newPos)){
				posMoves.push(newPos);
			}
		}
		/* check if there is en passant */
		var leftCell = board.cells[pos.y*board.width+(pos.x-1)];
		var rightCell = board.cells[pos.y*board.width+(pos.x+1)];
		var leftSameTeam = true,rightSameTeam = true;
		if(leftCell){leftSameTeam = this.player===leftCell.player;}
		if(rightCell){rightSameTeam = this.player===rightCell.player;}
		if((leftCell && !leftSameTeam) && leftCell.movesCount === 1 && ((this.player==0&&pos.y==3)||(this.player==1&&pos.y==4)) &&this.enPassantTime === board.time){
			var arr = [{x:-1,y:+1,enPassant:true}];
			this.multip(arr);
			arr[0].x+=pos.x;
			arr[0].y+=pos.y;
			if(this.checkInBoard(board,arr[0]) && arr[0].x===this.enPassantFile){posMoves.push(arr[0]);}
		}
		if((rightCell && !rightSameTeam) && rightCell.movesCount === 1 && ((this.player==0&&pos.y==3)||(this.player==1&&pos.y==4)) && this.enPassantTime === board.time){
			var arr = [{x:1,y:1,enPassant:true}];
			this.multip(arr);
			arr[0].x += pos.x;
			arr[0].y += pos.y;
			if(this.checkInBoard(board,arr[0]) && arr[0].x===this.enPassantFile){posMoves.push(arr[0]);}
		}
		return posMoves;
	}
	clone(){
		var newPiece = new ChessPawn(this.player);
		newPiece.movesCount = this.movesCount;
		newPiece.enPassantTime = this.enPassantTime;
		return newPiece;
	}
}
</script>
</body>
</html>
